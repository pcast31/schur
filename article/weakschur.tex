\section{Templates for weak Schur numbers}
\label{WeakSchur}

\qquad In this section, we generalize Rowley's constructions for weak Schur numbers \cite{RowleyWS} and give an analogous
for weak Schur numbers of Abbott and Hanson's construction for Schur numbers. By analogy with the previous section,
we then introduce WS-templates as well as an associated sequence \(\WS^+(n)\). We find templates and use them to
provide new lower bounds for weak Schur numbers.

\subsection{Inequality for weak Schur numbers using Schur and weak Schur numbers}

\qquad Up to now, no equivalent for weak Schur numbers of Abbott and Hanson's construction for Schur numbers
\cite{AbbottHanson} was known. Here we give a general lower bound for weak Schur numbers as a function of both
regular and weak Schur numbers. The following theorem, inspired by Rowley's inequalities for \(\WS (n+1)\) and
\(\WS (n+2)\), was found and proved by Romain Ageron.

\begin{theorem}
\label{Theorem3.1}
\begin{sloppypar}
Let \((p,k), (q,n) \in (\mathbb{N}^*)^2\). If there exists a partition of \([\![1,q]\!]\) into \(n\) weakly sum-free
subsets and a partition of \([\![1,p]\!]\) into \(k\) sum-free
subsets then there exists a partition of \({[\![1,p(q+\left \lceil \frac{q}{2} \right \rceil + 1)+q]\!]}\) into \(n+k\)
weakly sum-free subsets.
\end{sloppypar}
\end{theorem}

In particular, by setting \(q = \WS (n)\) and \(p = S(k)\) in \hyperref[Theorem3.1]{Theorem 3.1}, one obtains the following corollary.

\begin{corollary}
\label{Corollary3.2}
\( \forall (n,k) \in (\mathbb{N}^*)^2 \text{, } \WS (n+k) \geqslant S(k) \left (\WS (n) + \left \lceil \displaystyle \frac{\WS (n)}{2}
\right \rceil +1 \right) + \WS (n)\)
\end{corollary}

This can be seen as an equivalent for weak Schur numbers of Abott and Hanson's construction for Schur numbers. This formula includes
the results of Rowley \cite{RowleyWS} as a special case. For \(n>2\), this formula does not give new lower bounds.

\begin{remark}
The inequality from \hyperref[Corollary3.2]{Corollary 3.2} can be improved by adding 1 to the lower bound if \(\WS (n)\) is odd (more generally if \(q\) is
odd in the theorem). However, it lengthens the proof and it is never useful in practice.
\end{remark}

Given that \hyperref[Theorem3.1]{Theorem 3.1} will appear as a particular case of a more general theorem after the introduction of
templates for weak Schur numbers, we only give here an intuitive explanation of the demonstration; a formal
\hyperref[PreuveThm]{proof} using templates for weak Schur numbers is provided.

Let \((p, k), (q, n) \in (\mathbb{N}^*)^2\) such that there exists a partition of \([\![1,q]\!]\) into \(n\) weakly sum-free
subsets and a partition of \([\![1,p]\!]\) into \(k\) sum-free subsets. Let \(a \in \mathbb{N}\) with \(a > q\)
and let us try to build a coloring of \([\![1, ap + q]\!]\) into \(n + k\) weakly sum-free subsets. Let
\(l = a - b - 1\), \(r \in [\![1,q]\!]\) and \(w = a - l - r - 1 = b - r\).

First, we put the integers of \([\![1, ap + q]\!]\) in the following table (with \(a\) columns and \(p + 1\) lines)
and divide it into 3 blocks (the columns are numbered from \(-l\) to \(+q\)).

\begin{itemize}
	\item \(\mathcal{T}\) (the "tail"): the integers from 1 to \(q\). NB: this is line number 0.
	\item \(\mathcal{R}\) (the "rows"): the integers in columns \(-l\) to \(+r\) (excluding  \(\mathcal{T}\)).
	\item \(\mathcal{C}\) (the "columns"): the integers in the last \(w\) columns (excluding  \(\mathcal{T}\)).
\end{itemize}

Like S-templates, \(\mathcal{R}\) and \(\mathcal{C}\) play the role of security zones for each other. Note that with
this numbering of columns, the column of the sum of two numbers is the only integer in \([\![-l,q]\!]\) equal to two the
sum of the columns modulo \(a\).

\renewcommand{\arraystretch}{1.7}
\setlength{\arraycolsep}{3pt}

\begin{figure}[H]
\[
\begin{NiceArray}{*{13}{c}}[corners={NW,SW},hvlines,first-row,last-row,first-col]
\CodeBefore
	\cellcolor{green}{1-6}
	\cellcolor{green}{1-7}
	\cellcolor{cyan}{1-8}
	\cellcolor{green}{1-9}
	\cellcolor{cyan}{1-10}
	\cellcolor{cyan}{1-11}
	\cellcolor{cyan}{1-12}
	\cellcolor{green}{1-13}
	\cellcolor{red}{2-1}
	\cellcolor{red}{2-2}
	\cellcolor{red}{2-3}
	\cellcolor{red}{2-4}
	\cellcolor{red}{2-5}
	\cellcolor{red}{2-6}
	\cellcolor{red}{2-7}
	\cellcolor{red}{2-8}
	\cellcolor{red}{2-9}
	\cellcolor{cyan}{2-10}
	\cellcolor{cyan}{2-11}
	\cellcolor{cyan}{2-12}
	\cellcolor{green}{2-13}
	\cellcolor{yellow}{3-1}
	\cellcolor{yellow}{3-2}
	\cellcolor{yellow}{3-3}
	\cellcolor{yellow}{3-4}
	\cellcolor{yellow}{3-5}
	\cellcolor{yellow}{3-6}
	\cellcolor{yellow}{3-7}
	\cellcolor{yellow}{3-8}
	\cellcolor{yellow}{3-9}
	\cellcolor{cyan}{3-10}
	\cellcolor{cyan}{3-11}
	\cellcolor{cyan}{3-12}
	\cellcolor{green}{3-13}
	\cellcolor{yellow}{4-1}
	\cellcolor{yellow}{4-2}
	\cellcolor{yellow}{4-3}
	\cellcolor{yellow}{4-4}
	\cellcolor{yellow}{4-5}
	\cellcolor{yellow}{4-6}
	\cellcolor{yellow}{4-7}
	\cellcolor{yellow}{4-8}
	\cellcolor{yellow}{4-9}
	\cellcolor{cyan}{4-10}
	\cellcolor{cyan}{4-11}
	\cellcolor{cyan}{4-12}
	\cellcolor{green}{4-13}
	\cellcolor{red}{5-1}
	\cellcolor{red}{5-2}
	\cellcolor{red}{5-3}
	\cellcolor{red}{5-4}
	\cellcolor{red}{5-5}
	\cellcolor{red}{5-6}
	\cellcolor{red}{5-7}
	\cellcolor{red}{5-8}
	\cellcolor{red}{5-9}
	\cellcolor{cyan}{5-10}
	\cellcolor{cyan}{5-11}
	\cellcolor{cyan}{5-12}
	\cellcolor{green}{5-13}
	\cellcolor{cyan}{6-10}
	\cellcolor{cyan}{6-11}
	\cellcolor{cyan}{6-12}
	\cellcolor{green}{6-13}
\Body
	& & & & & & \Block{1-8}{\overbrace{\hphantom{---------------------------}}^{\mathcal{T}}} \\
	& & & & & & 1 & 2 & ... & r & r + 1 & ... & b - 1 & b \\
	\Block{5-1}{\mathcal{R} \left\{ \vphantom{\begin{array}{l} . \\ . \\ . \\ . \\ . \\ . \\ . \\ . \\ . \end{array}} \right.}
	& a - l & a - l + 1 & ... & a - 1 & a & a + 1 & ... & a + r - 1 & a + r & a + r + 1 & ... & a + b - 1 & a + b \\
	& 2 a - l & ... & ... & ... & 2 a & ... & ... & ... & 2 a + r & ... & ... & ... & 2 a + b \\
	& ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... \\
	& ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... \\
	& p a - l & ... & ... & ... & p a & ... & ... & ... & p a + r & ... & ... & ... & p a + b \\
	& & & & & & & & & & \Block{1-4}{\underbrace{\hphantom{--------------}}_{\mathcal{C}}} \\
\end{NiceArray}
\]
\label{SchemaWS}
\caption{Construction of the weakly sum-free coloring}
\end{figure}

\resetarraystretch
\setlength{\arraycolsep}{6pt}

\noindent \underline{\textbf{\(\mathcal{T}\) block}}
\par
We color this block using the weakly sum-free coloring of \([\![1,q]\!]\) with colors \(1, ..., n\).

\noindent \underline{\textbf{\(\mathcal{R}\) block}}
\par
In this block,  we use the colors \(n + 1, ..., n + k\). We color an integer \(x\) according to its line number (written \(\lambda(x)\)).
For every \(x \in \mathcal{R}\), we color \(x\) with \(n + c\) where \(c\) is the color of \(\lambda(x)\) in the sum-free coloring of  \([\![1,p]\!]\).
Let \((x, y) \in \mathcal{R}^2\). The cases are twofold.

\begin{itemize}
	\item \underline{\(\lambda(x+y) = \lambda(x) + \lambda(y)\)} \\
	In this case, we use the sum-free property of the coloring of \([\![1,p]\!]\) (in block \(\mathcal{C}\), we only
	use colors \(1, ..., n\)).
	\item \underline{\(\lambda(x+y) \neq \lambda(x) + \lambda(y)\)} \\
	In this case, we do not have information about the color of \(\lambda(x+y)\). Thereby, we want to have
	\(x+y \in \mathcal{C}\). A simple solution is to limit the horizontal movement, that is if the sum changes line
	(that is its line number is different from \(\lambda(x) + \lambda(y)\)), not to move too far from \((\lambda(x)
	+ \lambda(y)) a\) so that the sum stays in \(\mathcal{C}\). There, the maximal displacement to the left (resp.
	to the right) is \(2l\) (resp. \(2r\)). Not crossing entirely \(\mathcal{C}\) by going to the left is then expressed
	as \(-2l > -a + r\). Likewise, not going to far to the right is expressed as \(2r < a - l\). It can then be written
	as \(\max(l, r) \leqslant w\).
\end{itemize}

\noindent \underline{\textbf{\(\mathcal{C}\) block}}
\par
In this block,  we use colors \(1, ..., n\). We color an integer \(x\) according to its column number, denoted by \(\tilde{\pi}(x)\). It is linked to the
projection on the first line, denoted by \(\pi\), by the relation \(\tilde{\pi}(x) = \pi(x) - a\). A simple solution is to color \(x\) with the same color
as \(\tilde{\pi}(x)\) in the weakly sum-free coloring of \([\![1,q]\!]\). As long as \(2b \leqslant a + r\) (not going two far to the right) and there
is no \(x \in \tilde{\pi}(\mathcal{C})\) such that \(2x \in \tilde{\pi}(\mathcal{C})\) (so that we do not have a sum in \(\mathcal{C}\) when
taking two numbers in the same column), the colors \(1, ..., n\) are sum-free.

In particular, taking \(w = l = \left\lceil \displaystyle \frac{q}{2} \right\rceil\) and \(r = \left\lfloor \displaystyle \frac{q}{2} \right\rfloor\) works, thus obtaining the above theorem.\\
\par
As in the previous section, we now introduce WS-templates and the sequence \(\WS^+\) in order to generalize the above construction.

\subsection{Definition of \(\WS^+\)}
\label{DefinitionWS+}

\qquad In this subsection, we introduce WS-templates and prove calculative results for the general construction
theorem on templates for weak Schur numbers.

\begin{definition}
Let \((a,b) \in (\mathbb{N}^*)^2\) such that \(a>b\). We define :
\[ \pi_{a,b}:x \longmapsto (\operatorname{Id}+a\mathds{1}_{ [\![0,b]\!]})(x \mod a).\]
\end{definition}

\begin{sloppypar}
If there is no confusion on the \(a\) and \(b\) to use, \(\pi_{a, b}\) is denoted by \(\pi\). Notice that for all \(x \in \mathbb{Z}\), 
\({\pi(x) = x \mod a}\) and for all \(x \in [\![b + 1, a + b]\!], b + 1 \leqslant \pi(x) \leqslant a + b\).
\end{sloppypar}

\begin{sloppypar}
\(\pi\) is the projection on the first line mentioned in the intuitive explanation. The following four propositions are
calculative properties on \(\pi\) reflecting the behaviour of an element's column number in \hyperref[SchemaWS]{Figure 3} and
that we will use later when we introduce WS-templates.
\end{sloppypar}

\begin{proposition}
\label{prop1}
\[
\forall x \in [\![b + 1, a + b]\!], \pi(x) = x
\]
\end{proposition}

\begin{proof}[\textsc{Proof.}]
\begin{sloppypar}
Let \(x \in [\![b + 1, a + b]\!]\). If \(x < a\) then \(x \mod a = x \notin [\![1, b]\!]\). Hence \(\pi(x) = x\).
Otherwise, \({x \mod a = x - a \in [\![1, b]\!]}\). Hence \({\pi(x) = x - a + a = x}\).
\end{sloppypar}
\end{proof}

\begin{proposition}
\label{prop2}
Let x \(\in [\![1,b]\!]\) and \(y \in \mathbb{N}^*\). Then
\[
\pi(x+\pi(y)) = \pi(x+y)
\]
\end{proposition}

\begin{proof}[\textsc{Proof.}]
It is a direct consequence of \(\pi(x) = x \mod a\). \\
\end{proof}

\begin{proposition}
\label{prop3}
Let x \(\in [\![1,b]\!]\) and \(y \in \mathbb{N}^*\) such that \(x+\pi(y) \leqslant a+b\). Then
\[
\pi(x+y)=x+\pi(y)
\]
\end{proposition}

\begin{proof}[\textsc{Proof.}]
\(\pi(y) \geqslant b + 1\) and thus \(b + 1 \leqslant x + \pi(y) \leqslant a + b\).
\[
\begin{array}{l l l l}
	\pi(x + y) & = & \pi(x + \pi(y)) & \text{by \hyperref[prop2]{Proposition 3.6}} \\
	 & = & x + \pi(y) & \text{by \hyperref[prop1]{Proposition 3.5}}
\end{array}
\]
\end{proof}

\begin{proposition}
\label{prop4}
Let \((x,y)\in (\mathbb{N}^*)^2\). Then
\[
\pi(\pi(x)+\pi(y))=\pi(x+y)
\]
\end{proposition}

\begin{proof}[\textsc{Proof.}]
It is a direct consequence of \(\pi(x) = x \mod a\). \\
\end{proof}

After defining the function related to the column number of each element in \hyperref[SchemaWS]{Figure 3},
we introduce the function related to its line number.

\begin{definition}
Let \((a,b) \in (\mathbb{N}^*)^2\) such that \(a>b\). Define
\[ \lambda_{a,b}:x \longmapsto 1+ \left\lfloor\dfrac{x-b-1}{a}\right\rfloor\]
\end{definition}

If there is no confusion on the \(a\) and \(b\) to use, \(\lambda_{a, b}\) is denoted by \(\lambda\).

Function \(\lambda\) maps an element \(x\) to its line number as mentioned in the intuitive explanation.
As we just did with \(\pi\), we proove three more results on both \(\pi\) and \(\lambda\) that will appear useful in
\hyperref[ConstructionWS]{Subsection 3.3}.

\begin{proposition}
\label{prop5}
Let \(x\in \mathbb{N}^*\). Then
\[
x=a\lambda(x)+\pi(x)-a
\]
\end{proposition}

\begin{proof}[\textsc{Proof.}]
Let \((a,b)\in (\mathbb{N}^*)^2\) such that \(a>b\) and let \(x\in \mathbb{N}^*\). \\
\(a\lambda(x)+\pi(x)-a=a\left\lfloor\dfrac{x-b-1}{a}\right\rfloor+(x \mod a)+ a \mathds{1}_{ [\![0,b]\!]}(x \mod a)\)

\begin{itemize}
\item if \(x \mod a>b\) then \(a\lambda(x)+\pi(x)-a=a\left\lfloor\dfrac{x}{a}\right\rfloor+x \mod a=x\)
\item if \(x \mod a \leqslant b\) then \(a\lambda(x)+\pi(x)-a=a \left( \left \lfloor \dfrac{x}{a} \right \rfloor - 1 \right)+x \mod a +a=x\)
\end{itemize}
\end{proof}

\begin{proposition}
\label{prop6}
Let \(x, y \in \mathbb{Z}\) such that \(\lambda(x + y) = \lambda(y)\). Then
\[
\pi(x + y) = x + \pi(y)
\]
\end{proposition}

\begin{proof}[\textsc{Proof.}]
By applying \hyperref[prop5]{Proposition 3.10} twice, we get \(a \lambda(x + y) + \pi(x + y) - a = x + y = x + a \lambda(y) + \pi(y) - a\).
The result is then obtained by simplying the equality. \\
\end{proof}

\begin{proposition}
\label{prop7}
Let \(x, y \in \mathbb{Z}\) such that \(\pi(x) + \pi(y) \in [\![a + b + 1, 2 a + b]\!]\). Then
\[
\lambda(x + y) = \lambda(x) + \lambda(y)
\]
\end{proposition}

\begin{proof}[\textsc{Proof.}]
By \hyperref[prop5]{Proposition 3.10}, \(x + y = a (\lambda(x) + \lambda(y)) + \pi(x) + \pi(y) - 2 a\). Then
\[
\begin{array}{l l l}
	\lambda(x + y) & = & \left \lfloor \dfrac{x + y - b - 1}{a} \right \rfloor + 1 \vspace{1mm} \\
	 & = & \left \lfloor \dfrac{a (\lambda(x) + \lambda(y)) + \pi(x) + \pi(y) - 2 a - b - 1}{a} \right \rfloor + 1 \vspace{1mm} \\
	 & = & \lambda(x) + \lambda(y) - 1 \left \lfloor \dfrac{\pi(x) + \pi(y) - b - 1}{a}\right\rfloor \\
	 & = & \lambda(x)+\lambda(y) -1 +1 ~~~~\text{since } \pi(x) + \pi(y) \in [\![a + b + 1, 2 a + b]\!] \\
	 & =& \lambda(x)+\lambda(y)
\end{array}
\]
\end{proof}

\begin{definition}
Let \( (a,n,b) \in (\mathbb{N}^*)^3\) with \(a > b\). Let \((A_1,...,A_n)\) a partition of  \([\![1, a + b]\!]\).
This partition is said to be a \(b\)-weakly-sum-free template (\(b\)-WS-template) with width \(a\) and \(n\) colors when :

\begin{itemize}
\item \(\forall i \in [\![1, n]\!], A_i\) is weakly-sum-free,
\item \(\forall i \in [\![1, n]\!], A_i\backslash [\![1, b]\!]\) is sum-free,
\item For \(A_n\) (the special subset) :
	\[
	\forall (x,y) \in A_n^2, \,x+y>b+2a \implies x+y-2a\notin A_n,
	\]
\item For the others subsets
	\[
	\forall i \in [\![1,n-1]\!], \, \forall(x,y) \in A_i^2, \, x+y>a+b \implies \pi(x+y) \notin A_i.
	\]
\end{itemize}
\end{definition}

Please note that the special color \(n\) is not necessarily the last color by order of appearance.
We now introduce the number \(\WS^+(n)\) that plays the same role as \(S^+(n)\) for S-templates.
However, WS-templates being more sophisticated than S-templates, the definition of \(\WS^+(n)\)
is slighty more complicted.

\begin{definition}
Let \( (n,b) \in (\mathbb{N}^*)^2\). If there exists \(a\) such that there exists a \(b\)-WS-template with width \(a\)
and \(n\) colors, we define :
\[
\WS_b^+(n)= \max \{a \in \mathbb{N}^*/ \text{there exists a } b \text{-WS-template with width } a \text{ and } n \text{ colors} \}.
\]
If no such \(a\) exists, we set \(\WS_b^+(n) = 0\).
\end{definition}

\begin{definition}
Let \( n \in \mathbb{N}^*\). We define :
\[
\WS^+(n)=\max_{b\in \mathbb{N}^*} \WS_b^+(n).
\]
\end{definition}
The following proposition briefly shows how \(\WS^+(n)\) compares to weak Schur numers.
\begin{proposition}
Let \(n \in [\![2, +\infty]\!]\). Then :
\[
\frac{3}{2} \WS (n-1)+1 \leqslant \WS^+(n) \leqslant \WS (n).
\]
\end{proposition}

\begin{proof}[\textsc{Proof.}]
The lower bound comes from the analogous of Abott and Hanson's construction for weak Schur numbers.
The upper bound comes from the fact that a WS-template with width \(a\) and \(n\) colors contains a partition of
\([\![1, a]\!]\) into \(n\) sum-free subsets. \\
\end{proof}

\begin{remark}
\(\WS^+\) and \(\WS\) have the same asymptotic growth rate.
\end{remark}

We now proceed to state and prove the main result of this article.


\subsection{Construction of weak Schur partitions using WS-templates}
\label{ConstructionWS}

\begin{theorem}
\label{Theorem3.18}
Let \((a,n,b) \in (\mathbb{N}^*)^3\) with \(a > b\) and \( (p,k) \in (\mathbb{N}^*)^2\). If there exists a partition of \([\![1,p]\!]\)
into \(k\) sum-free subsets and a \(b\)-WS-template \((A_1,...,A_{n+1})\) with width \(a\) and \(n+1\) colors,
then there exists a partition of \([\![1, p a + b]\!]\) into \(k+n\) weakly sum-free subsets.
\end{theorem}

In particular, by setting \(p = S(k)\) and \(a = \WS^+(n + 1)\) in \hyperref[Theorem3.18]{Theorem 3.18}, the next corollary follows.

\begin{corollary}
Let \(n,k \in \mathbb{N}^*\) and set \( b_{max} = \max \{b\in \mathbb{N}^*/ \WS_b^+(n+1) = \WS^+(n+1)\}\).
Then :
\[
\WS(n+k) \geqslant S(k) \WS^+(n+1)+b_{max}.
\]
\end{corollary}

\begin{remark}
In the S-template construction for Schur numbers, the additive constant comes from the fact that the special color does
not necessarily appear right at the begining of the repeating pattern. Likewise, \(b_{max}\) can actually be replaced by
\[
\max_{b \in \mathbb{N}^*} \left\{\min (A_{n+1} \backslash [\![1, b ]\!]) - 1~|~ \WS_b^+(n+1) = \WS^+(n+1) \right\}.
\]
\end{remark}

\begin{proof}[\textsc{Proof.}]
\begin{sloppypar}
Let \((a,n,b) \in (\mathbb{N}^*)^3\) and \((p,k) \in (\mathbb{N}^*)^2\). Denote by \(f\) the coloring
associated to the \(b\)-WS-template  and \(g\) the one associated to the sum-free partition of \([\![1,p]\!]\); where
\({f : [\![1, a + b]\!] \longrightarrow [\![1,n+1]\!]}\) and \({g : [\![1, p]\!]  \longrightarrow [\![1, k]\!]}\). Moreover, assume
that the sum-free coloring of \([\![1, p]\!]\) is ordered.
\end{sloppypar}

\par
NB: To keep the notation short, the conditions \(x + y \leqslant p\)  and \(x + y \leqslant a + b\) are omitted in the following five predicates.
\par
The (weakly) sum-free conditions are expressed as:
\begin{equation}
\forall (x,y) \in [\![1,a + b]\!]^2, \left\{
\begin{array}{l}
	f(x) = f(y) \\
	x \neq y
\end{array}
\right. \Longrightarrow f(x+y) \neq f(x),
\end{equation}
\begin{equation}
\forall (x,y) \in [\![b+1,a + b]\!]^2, f(x) = f(y) \Longrightarrow f(x+y) \neq f(x),
\end{equation}
\begin{equation}
\forall (x,y) \in [\![1,p]\!]^2, g(x) = g(y) \Longrightarrow g(x+y) \neq g(x).
\end{equation}

The additionnal constraints for the WS-template are:
\begin{equation}
\forall (x,y) \in [\![1,a + b]\!]^2, \left\{
\begin{array}{l}
	f(x) = f(y) \leqslant n \\
	x + y > a + b
\end{array}
\right. \Longrightarrow f(\pi(x+y)) \neq f(x),
\end{equation}
\begin{equation}
\forall (x,y) \in [\![1,a + b]\!]^2, \left\{
\begin{array}{l}
	f(x) = f(y) = n + 1 \\
	x + y > 2 a + b
\end{array}
\right. \Longrightarrow f(x+y - 2 a) \neq f(x).
\end{equation}

Split \([\![1, p a + b]\!]\) into three subsets. \\
NB: To keep the notation short, the restriction to \([\![b + 1, p a + b]\!]\) of \(\pi\) defined in \hyperref[DefinitionWS+]{Subsection 3.2}
is denoted by \(pi\) in the hereunder equations.

\begin{itemize}
	\item \(\mathcal{T} = [\![1, b]\!]\)
	\item \(\mathcal{C} = \pi^{-1}(f^{-1}([\![1, n]\!]))\)
	\item \(\mathcal{R} = \pi^{-1}(f^{-1}(\{n + 1\}))\)
\end{itemize}

A new coloring \(h\) is defined as follows:
\[
\begin{array}{c c c l}
	h : & [\![1, p a + b]\!] & \longrightarrow & [\![1,n+k]\!] \\
	& x & \longmapsto &
	\left\{ \begin{array}{l l}
		f(x) & \text{if}~x \in \mathcal{T} \\
		f(\pi(x)) & \text{if}~x \in \mathcal{C} \\
		n + g(\lambda(x)) & \text{if}~x \in \mathcal{R}
	\end{array} \right.
\end{array}
\]

Function \(h\) is well defined since \((\mathcal{T}, \mathcal{C}, \mathcal{R})\) is a partition of  \([\![1, p a + b]\!]\).
We now prove that \(h\) is a weakly sum-free coloring. Let \(x,y \in [\![1, p a + b]\!]\) be such that \(x \neq y\),
\(h(x) = h(y)\) and \(x+y \leqslant p a+ b\). We claim that \(h(x+y) \neq h(x)\). Nine cases are to be distinguished
according to the subsets \((\mathcal{T}, \mathcal{C}, \mathcal{R})\) to which \(x\) and \(y\) belong. It is
sufficient to check only six cases out of nine since \(x\) and \(y\) play symmetric roles. \\

\noindent \underline{\textbf{Case 1:} \((x,y) \in \mathcal{T}^2\)}
\par
If \(x + y \leqslant b\) then \(h(x+y)=f(x+y)\). Otherwise, \(b < x+y < a+b\) since \(b < a\) and
therefore \(\pi(x + y) = x +y\) (\hyperref[prop1]{Proposition 3.5}). Hence in both cases \(h(x+y)=f(x+y)\). Given that
\(f\) is a weakly sum-free coloring, \(f(x + y) \neq f(x)\) since \(f(x)=h(x)=h(y)=f(y)\) and \(x \neq y \). That
is \(h(x + y) \neq h(x)\). \\

\noindent \underline{\textbf{Case 2:} \((x,y) \in \mathcal{T} \times \mathcal{C}\)}
\par
Given that \(h(x) = h(y)\) and by definition of \(h\), \(f(x) = f(\pi(y))\). Besides, \(f(\pi(y)) \leqslant n\) since
\(y \in \mathcal{C}\). Two cases are to be distinguished according to the value of \(x + \pi(y)\).
\begin{itemize}
\item \begin{sloppypar}
	If \(x + \pi(y) \leqslant a + b\) then \(f(x + \pi(y)) = f(\pi(x + y))\) (\hyperref[prop3]{Proposition 3.7}). Given that \(f\) is
	a weakly sum-free coloring, \(f(x+\pi(y)) \neq f(x)\) since \(f(x)=f(\pi(y))\) and \(x \neq \pi(y)\) since
	\({x \leqslant b < \pi(y)}\).
	\end{sloppypar}
\item \begin{sloppypar}
	If \(x+\pi(y)> a+b\) then given that \(f\) is a WS-template and since \({f(x) = f(\pi(y)) \leqslant n}\),
	\({f(\pi(x+\pi(y))) \neq f(x)}\).~Furthermore \({f(\pi(x+\pi(y))) = f(\pi(x+y))}\) (\hyperref[prop2]{Proposition 3.6}), such that
	\({f(\pi(x+ y)) \neq f(x)}\).
	\end{sloppypar}
\end{itemize}
\par
Hence in both cases \(f(\pi(x+y)) \neq f(x)\). If  \(f(\pi(x+y)) \leqslant n\) then \(h(x+y) = f(\pi(x+y))\). Therefore
\(h(x+y) \neq h(x)\) since \(f(x) = h(x)\). Otherwise, \(f(\pi(x+y)) = n + 1\) and thus \(h(x+y) > n\). In particular,
\(h(x + y) \neq h(x)\) since \(h(x) = h(y) \leqslant n\). \\

\noindent \underline{\textbf{Case 3:} \((x,y) \in \mathcal{T} \times \mathcal{R}\)}
\par
Necessarily \(h(x) = h(y) = n + 1\). Two cases are to be distinguished according to the value of \(\lambda(x+y)\).
\begin{itemize}
\item If \(\lambda(y)=\lambda(x+y)\) then \(\pi(x + y) = x + \pi(y)\) (\hyperref[prop6]{Proposition 3.11}). By definition of
	\(h\), \(f(x) = f(\pi(y))\). Given that \(f\) is a weakly sum-free coloring, \(f(x + \pi(y)) \neq f(x)\) since
	\(f(x) = f(\pi(y))\) and \(x \neq \pi(y)\) since \({x \leqslant b < \pi(y)}\). Hence \(h(x + y) \neq h(x)\).
\item If \(\lambda(y) \neq \lambda(x + y)\) then \(\lambda(x + y) = \lambda(y) + 1\) since \(x \leqslant b < a\).
	Besides, \(n + 1 = h(y) = n +  g(\lambda(y))\). Hence \(g(\lambda(y)) = 1\). Moreover \(g(1) = 1\) since \(g\)
	is an ordered coloring. Therefore, given that \(g\) is sum-free, \(g(\lambda(y) + 1) \neq 1\). If \(\pi(x + y) \in
	A_{n + 1}\) then \(h(x + y) = n + g(\lambda(x + y)) \neq n + 1\). Otherwise, \(h(x + y) \leqslant n\). Hence
	in both cases \(h(x + y) \neq h(x)\).
\end{itemize}

\noindent \underline{\textbf{Case 4:} \((x,y) \in \mathcal{C}^2\)}
\par
By definition of \(h\) and since \(h(x)=h(y)\), \(f(\pi(x)) = f(\pi(y))\). Two cases are to be distinguished according
to the value of \(\pi(x)+\pi(y)\).
\begin{itemize}
\item If \(\pi(x) + \pi(y) \leqslant a+b\) then \(\pi(x)+\pi(y) = \pi(x + y)\). Hence \(f(\pi(x + y)) \neq f(\pi(x))\) since
	\(f\) is sum-free for \(x>b\)
\item \begin{sloppypar}
	If \(\pi(x)+\pi(y)>a+b\) then given that \(f\) is a WS-template, \({f(\pi(\pi(x)+\pi(y))) \neq f(\pi(x))}\) since
	\({f(\pi(x)) = f(\pi(y))}\). Besides,  \({f(\pi(\pi(x)+\pi(y))) = f(\pi(x + y))}\) (\hyperref[prop4]{Proposition 3.8}). Hence \({f(\pi(x + y))
	\neq  f(\pi(x))}\).
	\end{sloppypar}
\end{itemize}
\par
Hence in both cases \(f(\pi(x+y)) \neq f(x)\). If  \(f(\pi(x+y)) \leqslant n\) then \(h(x+y) = f(\pi(x+y))\). Therefore
\(h(x+y) \neq h(x)\) since \(f(x) = h(x)\). Otherwise, \(f(\pi(x+y)) = n + 1\) and thus \(h(x+y) > n\). In particular,
\(h(x + y) \neq h(x)\) since \(h(x) = h(y) \leqslant n\). \\

\noindent \underline{\textbf{Case 5:} \((x,y) \in \mathcal{C} \times \mathcal{R}\)}
\par
By definition of \(h\), \(h(x) \neq h(y)\).\\

\noindent \underline{\textbf{Case 6:} \((x,y) \in \mathcal{R}^2\)}
\par
In particular \(f(\pi(x)) = f(\pi(y))=n + 1\). Three cases are to be distinguished according to the value of \(\pi(x) + \pi(y)\).
\begin{itemize}
\item If \(\pi(x) + \pi(y) \in [\![a + b + 1, 2 a + b]\!]\) then \(\lambda(x + y) = \lambda(x) + \lambda(y)\)
	(\hyperref[prop7]{Proposition 3.12}). By definition of \(h\) and since \(h(x) = h(y)\), \(g(\lambda(x)) = g(\lambda(y))\).
	Hence, \(h(\lambda(x + y)) \neq h(\lambda(x))\) since \(h\) is a sum-free coloring. If \(f(x+y) \geqslant n + 1\)
	then \(h(x + y) = n + g(\lambda(x + y))\). And \(h(x) = n + g(\lambda(x))\). Therefore, \(h(x + y)  \neq h(x)\).
	Otherwise \(h(x+y) \leqslant n < h(x)\). In particular \(h(x + y) \neq h(x)\).
\item If \(\pi(x)+\pi(y)>2a+b\) then \(f(\pi(\pi(x)+\pi(y))) \neq f(\pi(x)) = n + 1\) since \(f\) is a \(b\)-WS template and
	\(f(\pi(x)) = f(\pi(y))\). Given that \(\pi(\pi(x)+\pi(y)) = \pi(x+y)\) (\hyperref[prop4]{Proposition 3.8}), \(f(\pi(x+y)) \neq n + 1\).
\item \begin{sloppypar}
	If \(\pi(x)+\pi(y)\leqslant b+a\) then, given that \(\pi(x)+\pi(y) \geqslant b\) and \(f_{| [\![b, a + b ]\!]}\) is
	sum-free, \({f(\pi(x) + \pi(y)) \neq f(\pi(x)) = n + 1}\). That is \({f(\pi(x + y)) \neq n + 1}\) (\hyperref[prop1]{Proposition 3.5}).
	\end{sloppypar}
\end{itemize}
\par
In both of the last two cases, \({f(\pi(x + y)) \neq n + 1}\) that is \(x+y \in \mathcal{C}\). Therefore \(h(x+y) < n \leqslant h(x)\).
In particular, \(h(x + y) \neq h(x)\). \\
\end{proof}

There is a construction theorem for WS-templates as well.

\begin{theorem}
\label{Theorem3.21}
Let \((k,p) \in (\mathbb{N}^*)^2\) and \((a, n, b) \in (\mathbb{N}^*)^3\). If there exists a S-template with width
\(p\) and \(k+1\) colors and a \(b\)-WS-template with width \(a\) and \(n\) colors, then there exists a \(pb\)-WS-template
with width \(pq\) and \((n+k)\) colors.
\end{theorem}

\hyperref[Theorem3.21]{Theorem 3.21} yields the following corollary.

\begin{corollary}
Let \(n, k \in \mathbb{N}^*\). Then
\[
\WS^+(n+k) \geqslant S^+(k+1) \WS^+(n)
\]
\end{corollary}

\begin{proof}[\textsc{Proof.}]
The idea is the same as in the previous theorem. The only difference is the WS property inherited
from the WS-template. \\
\end{proof}

\hyperref[Theorem3.1]{Theorem 3.1} can be seen as a particular case of WS-template in the same way Abott and Hanson's 
construction can be seen as a particular case of S-template.

\begin{proof}[\textsc{Proof of \hyperref[Theorem3.1]{Theorem 3.1}.}]
\label{PreuveThm}
Let \((q, n) \in (\mathbb{N}^*)^2\) such that there exists a partition of \([\![1, q]\!]\) into n weakly sum-free subsets. 
Let \(f: [\![1, q]\!] \rightarrow [\!]1, n]\!]\) a weakly sum-free colouring.
Let \(b=q\) and \(a = q + \left \lceil \dfrac{q}{2} \right \rceil + 1\). A new colouring \(g\) is defined as follows:

\[
\begin{array}{c c c l}
	g : & [\![1, a + b]\!] & \longrightarrow & [\![1, n + 1]\!] \\
	& x & \longmapsto &
		\left\{ \begin{array}{l l}
			f(x) & \text{if}~x \in [\![1, b]\!]  \\
			n + 1 & \text{if}~x \in [\![b + 1, 2 b + 1]\!] \\
			f(x - a) & \text{if}~x \in  [\![2 b + 2, a + b]\!]
		\end{array} \right.
\end{array}
\]

We claim that \(g\) is a \(b\)-WSF-template with width \(a\) and \(n + 1\) colours.

\begin{itemize}
\item Function \(g_{|[\![b + 1, a + b]\!]}\) is a sum-free colouring. Indeed, let \((x, y) \in 
	[\![b + 1, a + b]\!]^2\) such that \(g(x) = g(y)\). If \(g(x) = n + 1\) then \(z = x + y > 2 b + 1\) 
	and therefore, either \(z > a + b\) or \(f(z) \neq n + 1\). Otherwise, \(x + y > a + b\).
\item Function \(g\) is a weakly sum-free colouring. Indeed, let \((x, y) \in [\![1, a + b]\!]^2\) such that 
	\(z = x + y \leqslant a + b\) and \(g(x) = g(y)\). Given that \(x\) and \(y\) have symmetric roles, 
	we can assume that \(x \leqslant y\). If \(x > b\) then \(g(z) \neq g(x)\) as seen above. If \(y \leqslant b\) then 
	\(f(x) = g(x) = g(y) = f(y) \leqslant n\) and either \(z \leqslant a + b\) and \(f(z) \neq f(x)\) since \(f\) is a weakly 
	sun-free colouring or \(a + b + 1 \leqslant z \leqslant 2 b\) and \(g(z) = n + 1\); therefore \(g(z) \neq g(x)\). If 
	\(x \leqslant b\) and \(y > b\) then \(g(x) = f(x)\), \(g(y) = f(y - a)\) and \(g(z) = f(z - a)\).We have \(x \neq y - a\) 
	(otherwise, we would have \(a + b \geqslant z = 2 y  - a \geqslant 4 b + 4 - a > a + b\)) and thus \(f(x + y - a) \neq f(x)\),
	that is \(g(z) \neq g(x)\).
\item Colour \(n + 1\) verifies the additionnal constraints for the special colour. Indeed, \(b + 2 a \geqslant 4 b + 2\). 
	Hence, \(\forall (x, y) \in g^{-1}(\{n + 1\}), x + y \leqslant b + 2 a\).
\item Colours \(1, ..., n\) verify the additionnal constraints for the regular colours. Indeed, let 
	\((x, y) \in g^{-1}([\![1, n]\!])\) such that \(x + y > a + b\). Given that \(x\) and \(y\) have symmetric roles, 
	we can assume that \(x \leqslant y\). Necessarily \(y \geqslant 2 b + 2\). If \(x \leqslant b\) then 
	\(z = x + y \in [\![a + b + 1, a + 2 b]\!]\) and therefore \(\pi(z) \in [\![b + 1, 2 b]\!]\). Otherwise, 
	\(z = x + y \in [\![4 b + 4, 2 a + 2 b]\!]\) and therefore \(\pi(z) \in [\![b + 1, 2 b]\!]\). Hence, in both cases, 
	\(g(\pi(z)) \neq g(x)\).
\end{itemize}

The result is then obtained by applying \hyperref[Theorem3.18]{Theorem 3.18}. \\
\end{proof}

As in \hyperref[Corollary2.5]{Corollary 2.5}, the additive constant \hyperref[Theorem3.18]{Theorem 3.18} can be improved 
by weakening the hypotheses made on the last row. The principle behind it is the same as in \hyperref[Proposition2.6]{Proposition 2.6}.

\begin{proposition}
Let \((b, k, a) \in (\mathbb{N}^*)^3\) and let \(f\) be a coloring associated to a \(b\)-WS-template with width \(p\) and \(k\) colors. Let
\(c \in \mathbb{N}\) and assume there there exists a coloring \(g\) of \([\![b + 1, b + c]\!]\) with \(k\) colors such that for all \(c \in [\![1, k]\!]\),

\begin{itemize}
\item \(\forall (x, y) \in  [\![1, a + b]\!] \times  [\![b + 1, a + b]\!],  \left\{
	\begin{array}{l}
		f(x) = f(y) \\
		\pi(x + y) \leqslant b + c
	\end{array}
	\right. \implies g(\pi(x + y)) \neq f(x)\)
\item \(\forall (x, y) \in  [\![1, a + b]\!] \times  [\![b + 1, b + c]\!], \left\{
	\begin{array}{l}
		f(x) = g(y) \\
		\pi(x + y) \leqslant b + c
	\end{array}
	\right. \implies g(\pi(x + y)) \neq f(x)\)
\end{itemize}

Then, for every \(n \in \mathbb{N}^*\), by using on the last row the coloring \(x \longmapsto g(x - p S(n))\), we have\\
\[ \WS(n+k) \geqslant \WS^+(k+1) S(n) + b + c\]
\end{proposition}

The WS-templates can actually be fine-tuned further. However, it only gives minor improvements (most likely only an additive
constant) at the cost of dramatically increasing the size of the search space. Therefore, it does not seem relevant to
use this sophistications given that we could not even find good WS-templates with five colors using a computer (here good
means better than those obtain by combining smaller templates).

\par These modifications work as follows. One may notice that the first row (excluding the "tail") has constraints that other rows
do not have because of the tail, especially if the special color appears in the tail as well. Thus allowing to have a coloring on the
first row different from the coloring of the other rows would weaken the constraints. Acutally, one may even go further by
noticing that on the one hand the first (ordered) color of the sum-free partition used for the extension procedure has more
more constraints than the other colors of the sum-free partition since the first row is of this color and is more constrained than
the other rows, but that on the other hand it has more degrees of freedom than the other colors of the sum-free partition since in
the sum-free partition there cannot be two consecutive numbers of this color. As a result, it removes  some constraints imposed
 by the first row on the other rows.

\par
To sum up, one can look for a generalised WS-template that uses a special coloring for the tail and the first row, a
coloring dedicated to the rows whose number is not 1 but is in the first color in the sum-free partition, a coloring for all
the other rows and a special coloring for the last numbers (as previously explained for the improvement of the additive
constant of WS-templates).

We also have a similar theorem where only \(\WS^+\) is involved.


\subsection{New lower bounds for Weak Schur numbers}

\qquad We produced WS-templates using a SAT solver, hence providing lower bound on \(WS^+\) and inequalities
of the type \(WS(n+k) \geqslant a S(n) + b\). We sought templates providing the greatest value of \((a, b)\) (in the 
lexicographic order). Details concerning the encoding as a SAT problem can be found in \cite{Heule2017}.

\par
Here are the inequalities given by the current best WS-templates (to our knowledge). The \hyperref[WS-templates]{templates} 
corresponding to the third inequality can be found in the appendix.

\begin{align}
	WS(n + 1) &\geqslant  4\,S(n)  +  2 \label{WS(n+1)} \\
	WS(n + 2) &\geqslant  13\,S(n)  +  8 \label{WS(n+2)} \\
	WS(n + 3) &\geqslant  42\,S(n)  +  24 \label{WS(n+3)} \\
	WS(n + 4) &\geqslant  132\,S(n)  +  26 \label{WS(n+4)}
\end{align}

Inequalities (\ref{WS(n+1)}) and (\ref{WS(n+2)}) were found by Rowley, they are detailed in \cite{RowleyWS}. 
Inequality (\ref{WS(n+3)}) is cannot be further improved and was found with a SAT solver. It uses the first 
sophistication explained in the \hyperref[ConstructionWS]{Subsection 3.3} in order to add
the last number in the first color. As for inequality (\ref{WS(n+4)}), it was obtained by combining a S-template with 
width 33 with a WS-template with width 4. The best template we could find with a computer search gives the 
inequality \(\WS(n+4) \geqslant 127 S(n) + 68\). It was also found with the SAT solver. In order to reduce the search space, 
we only looked for WS-templates of five colors which start with a near-optimal \(\WS(4)\) partition and we assumed that the 
special color was the last by order of appearance. We highly suspect that bettert WS-templates with \(n \geqslant 5\) 
colors can be found but one would have not to use the above assumptions. One may try to go over a different search space 
using a Monte-Carlo method, as in \cite{Bouzy2015AnAP}. This could be the suject of a future work.

Like in \hyperref[Subsection2.3]{Subsection 2.3}, we compute the lower bounds given by inequalities (\ref{WS(n+1)}),
(\ref{WS(n+2)}) and (\ref{WS(n+3)}) for \( n \in [\![8,15]\!] \). The best lower bound for each value of \(n\) is highlighted.

\renewcommand{\arraystretch}{0.2}

\begin{table}[H]

\label{LowerBoundsWS}
\[
\begin{array}{c}
	\resetarraystretch
	\begin{NiceArray}{cwc{8ex}wc{10ex}wc{10ex}wc{11ex}}[hvlines]
	\CodeBefore
		\cellcolor{yellow}{2-4}
		\cellcolor{yellow}{2-5}
		\cellcolor{yellow}{3-2}
		\cellcolor{yellow}{4-3}
	\Body
		n & 8 & 9 & 10 & 11 \\
		4 \, S(n-1) + 2 & 6\,722 & 21\,146 & 71\,214 & 243\,794 \\
		13 \, S(n-2) + 8 & 6\,976 & 21\,848 & 68\,726 & 231\,447 \\
		42 \, S(n-3) + 24 & 6\,744 & 22\,536 & 70\,584 & 222\,036 \\
	\end{NiceArray}
	\\ \\
	\resetarraystretch
	\begin{NiceArray}{cwc{8ex}wc{10ex}wc{10ex}wc{11ex}}[hvlines]
	\CodeBefore
		\cellcolor{yellow}{2-2}
		\cellcolor{yellow}{2-5}
		\cellcolor{yellow}{3-3}
		\cellcolor{yellow}{4-4}
	\Body
		n & 12 & 13 & 14 & 15 \\
		4 \, S(n-1) + 2 & 815\,314 & 2\,554\,194 & 8\,045\,162 & 27\,061\,154 \\
		13 \, S(n-2) + 8 & 792\,332 & 2\,649\,772 & 8\,301\,132 & 26\,146\,778 \\
		42 \, S(n-3) + 24 & 747\,750 & 2\,559\,840 & 8\,560\,800 &  25\,886\,224 \\
	\end{NiceArray}
\end{array}
\]
\caption{New lower bounds for \( n \in [\![8,15]\!] \)}
\end{table}

\resetarraystretch

With \( S(9) \geqslant 17\,803 \), we found a new lower bound for \(\WS(10)\) using (\ref{WS(n+1)}).
Moreover, inequality (\ref{WS(n+3)}) gives new lower bounds for \(\WS(9)\) and \(WS(14)\).


\subsection{Conclusion on WS-templates}

\qquad We started by giving a new construction which can be seen as an equivalent for weakly sum-free partitions of Abott
and Hanson's construction for sum-free partitions. We then generalized this construction by introducing WS-templates. This
allows us to find new lower bounds and new inequalities for weak Schur numbers. One may notice the significant gap
between the former lower bounds for weak Schur numbers obtained by conducting a computer search and the new lower bounds
obtained with WS-templates.
