\section{Schur numbers}

\qquad In this section, we use Rowley's constructions \cite{RowleyRamsey} in the context of Schur numbers. To improve lower bounds
for Ramsay's numbers, Rowley introduces partitions verifying some properties which can be extended using a method which generalizes 
Abbott and Hanson's  construction \cite{AbbottHanson}. Rowley named these partitions "templates", and we will keep this name in the 
entire article. We find suitable templates and use them to find new lower bounds for Schur numbers.

\subsection{Definition of \(S^+\)}

\begin{definition}
We call SF-template of \(n\) colors and lenght \(p\) a partition of \( [\![1,p]\!]\) into \(n\) sum-free subsets \(A_1,
A_2, ..., A_n\) which verify :
	\[
	\forall i \in [\![1, n-1]\!], \forall (x,y) \in A_i^2, x+y > p
	\Longrightarrow x+y-p \notin A_i
	\]
	We note \(S^+(n)\) the maximal lenght for a SF-template of \(n\) colors.
\end{definition}

\begin{remark}
	Here, \(n\) is the "special" color: it has less constraints than the other colors. However, please note that \(n\) 
	is not necessarily the last color by order of appearance.
\end{remark}

\begin{remark}
	\(SF\)-templates include Abott and Hanson's construction \cite{AbbottHanson} as a special case.
\end{remark}

\begin{proposition}
	Let \(n \in [\![2, +\infty]\!]\), we have :
	\[
	2S(n-1)+1 \leqslant S^+(n) \leqslant S(n)
	\]
\end{proposition}

\textsc{Proof :} The lower bound comes from Abott and Hanson's construction. The upper bound comes
from the fact that a SF-template of length \(p\) with \(n\) colors is also a partition of
\([\![1, p]\!]\) into \(n\) sum-free subsets.

\begin{remark}
	\(S^+\) and \(S\) have the same asymptotic growth rate.
\end{remark}


\subsection{Inequalities using \(S^+\)}

The main result on \(S^+\) follows. It allows us to improve lower bounds on Schur numbers by computing \(S^+\).

\begin{theorem}
	Let \((n,k), (p,q) \in (\mathbb{N}^*)^2\). If there exists a \(SF\)-template of \(k+1\) colors and lenght \(p\),
	and a partition of \(n\) sum-free subsets of \([\![1,q]\!]\) then there exists a partition of \(n+k\) sum-free subsets
	of \([\![1,pq+m_{k+1}-1]\!]\). \(m_{k+1}\) is the first number colored with the \(k+1\)-th color in the \(SF\)-template.
\end{theorem}

Setting \(p = S^+(k+1)\) and \(q = S(n)\) yields the following corollary.

\begin{corollary}
	Let \(n, k \in \mathbb{N}^*\), we have \\
	\[ S(n+k) \geqslant S^+(k+1)S(n) + m_{k+1} - 1 \]
\end{corollary}

The idea lying beneath this inequality is similar to Abbott and Hanson's contruction \cite{AbbottHanson}. 
They extend vertically a sum-free partition, and horizontally an other sum-free partition. This way each "block" 
acts like a security zone for the other one. Here, the horizontal partition is no longer to the side of the 
vertical one, but it occupies the column of the special color of the \(SF\)-template, i.e the one without the 
extra condition. We give the following example for \(p = 7, q = 4, n = 2 ~\textrm{and}~ k = 2\). \\

This shows the inequality \(S(2+2) \geqslant S^+(3)S(2) + 4\). The special color is blue and is first used
to color 5, hence \(4 = m_{3} - 1\). 
We prooved \(S^+(3) = 9\). The special color is blue. 

\begin{center}
\[
\begin{array}{|*{9}{c|}}
	\multicolumn{9}{c}{\overset{S^+(3)}{\overbrace{\rule{6cm}{0pt}}}} \\
	\hline
	\cellcolor{red} 1 & \cellcolor{green} 2 & \cellcolor{green} 3 & \cellcolor{red} 4 & \cellcolor{blue} 5 & \cellcolor{blue} 6 & \cellcolor{red} 7 & \cellcolor{blue} 8 & \cellcolor{blue} 9 \\
	\hline
	\cellcolor{red} 10 & \cellcolor{green} 11 & \cellcolor{green} 12 & \cellcolor{red} 13 & \cellcolor{yellow} 14 & \cellcolor{yellow} 15 & \cellcolor{red} 16 & \cellcolor{yellow} 17 & \cellcolor{yellow} 18\\
	\hline
	\cellcolor{red} 19 & \cellcolor{green} 20 & \cellcolor{green} 21 & \cellcolor{red} 22 & \cellcolor{yellow} 23 & \cellcolor{yellow} 24 & \cellcolor{red} 25 & \cellcolor{yellow} 26 & \cellcolor{yellow} 27\\
	\hline
	\cellcolor{red} 28 & \cellcolor{green} 29 & \cellcolor{green} 30 & \cellcolor{red} 31 & \cellcolor{blue} 32 & \cellcolor{blue} 33 & \cellcolor{red} 34 & \cellcolor{blue} 35 & \cellcolor{blue} 36\\
	\hline
	\cellcolor{red} 37 & \cellcolor{green} 38 & \cellcolor{green} 39 & \cellcolor{red} 40 \\
	\cline{1-4}
\end{array}
\]
\end{center}


\begin{center}
\[
S^+(3) 
\begin{array}{|*{9}{c|}}
	\hline 
	\cellcolor{red} 1 & \cellcolor{green} 2 & \cellcolor{green} 3 & \cellcolor{red} 4 & \cellcolor{blue} 5 & \cellcolor{blue} 6 & \cellcolor{red} 7 & \cellcolor{blue} 8 & \cellcolor{blue} 9\\
	\hline
\end{array}  \]
\[
S(2) 
\begin{array}{|*{4}{c|}}
	\hline 
	\cellcolor{blue} 1 & \cellcolor{yellow} 2 & \cellcolor{yellow} 3 & \cellcolor{blue} 4 \\
	\hline
\end{array}
\]
\end{center}

To compare, here is a classic Abbott and Hanson partition : \(S(2+2) \geqslant S(2)(2S(2)+1)+S(2) \). 
\begin{center}
\[
\begin{array}{|*{9}{c|}}
	\multicolumn{4}{c}{\overset{S(2)}{\overbrace{\rule{2.6cm}{0pt}}}} \\
	\hline
	\cellcolor{red} 1 & \cellcolor{green} 2 & \cellcolor{green} 3 & \cellcolor{red} 4 & \cellcolor{blue} 5 & \cellcolor{blue} 6 & \cellcolor{blue} 7 & \cellcolor{blue} 8 & \cellcolor{blue} 9\\
	\hline
	\cellcolor{red} 10 & \cellcolor{green} 11 & \cellcolor{green} 12 & \cellcolor{red} 13 & \cellcolor{yellow} 14 & \cellcolor{yellow} 15 & \cellcolor{yellow} 16 & \cellcolor{yellow} 17 & \cellcolor{yellow} 18\\
	\hline
	\cellcolor{red} 19 & \cellcolor{green} 20 & \cellcolor{green} 21 & \cellcolor{red} 22 & \cellcolor{yellow} 23 & \cellcolor{yellow} 24 & \cellcolor{yellow} 25 & \cellcolor{yellow} 26 & \cellcolor{yellow} 27\\
	\hline
	\cellcolor{red} 28 & \cellcolor{green} 29 & \cellcolor{green} 30 & \cellcolor{red} 31 & \cellcolor{blue} 32 & \cellcolor{blue} 33 & \cellcolor{blue} 34 & \cellcolor{blue} 35 & \cellcolor{blue} 36 \\
	\hline
	\cellcolor{red} 37 & \cellcolor{green} 38 & \cellcolor{green} 39 & \cellcolor{red} 40 \\
	\cline{1-4}
\end{array}
\]
\end{center}

\textsc{Proof :} We denote by \(f\) the colouring associated to the \(SF\)-template of lenght \(p\)
and \(g\) the one associated to the sum-free partition of \([\![1,q]\!]\).

\[ f : [\![1,p]\!] \longrightarrow [\![1,k+1]\!] \text{ and } \forall (x,y) \in [\![1,p]\!]^2, \left\{
\begin{array}{ll}
	f(x) = f(y) \leqslant k \\
	x + y > p
\end{array}
\right.
\Longrightarrow f(x+y-p) \neq f(x)
\]
with also the sum-free condition : \[ \forall (x,y) \in [\![1,p]\!]^2 \text{, } f(x) = f(y)
\Longrightarrow f(x+y) \neq f(x) \]
Moreover, by definition of \(m_{k+1}\), if \(x < m_{k+1}\), \(f(x) \leqslant k\).

\[g : [\![1,q]\!] \longrightarrow [\![1,n]\!] \text{ and } \forall (x,y) \in [\![1,q]\!]^2 \text{, } g(x) = g(y)
\Longrightarrow g(x+y) \neq g(x)
\]

We now define \(h : [\![1,pq+m_{k+1}-1]\!] \longrightarrow [\![1,n+k]\!] \) as follows :
\( \forall x \in [\![1,pq + m_{k+1}-1]\!] \), we write \(x = \alpha p - u\) where \(\alpha \in [\![1,q+1]\!] \) and \( u \in
[\![0,p-1]\!] \).
This decomposition if of course unique. \\

If \(f(p-u) \leqslant k\), we set \(h(x) = f(p-u)\), else (i.e \(f(p-u) = k + 1)\) \(h(x) = k + g(\alpha) \). \\
If \(\alpha = q+1\), we have a problem plugging it into \(g\). Hopefully, this issue never arises : if 
\(\alpha = q+1\), we have \(u > p - m_{k+1}\) since \(x \in [\![1,pq + m_{k+1}-1]\!]\), hence \(p-u < m_{k+1}\) and \(f(p-u) \leqslant k\). \\

Prooving that the partition of \([\![1,pq]\!]\) induced by \(h\) is sum-free will complete the proof.\\

Let \(x,y \in [\![1,pq + m_{k+1}-1]\!]\), with \(h(x) = h(y)\) and \(x+y \leqslant pq+m_{k+1}-1\). We write \(x = \alpha p - u\) and \(y =
\beta p - v\). We simply need \(h(x+y) \neq h(x)\). \\

We first examine the case where \(h(x) \leqslant k\). We assume \(h(x+y) \leqslant k\), otherwise we are fine. 
Thus by definition of \(h\), we have \(h(x) = f(p-u) = f(p-v) = h(y)\).
\begin{itemize}
\item If \(u+v < p\), then \(x+y = (\alpha+\beta) - (u+v) \) with \(u+v \in [\![0,p-1]\!] \).
We have \(f(p-u) = f(p-v) \leqslant k\) and \(p-u + p-v > p\), the extra condition on \(f\) provides \(f(p-u-v) \neq
f(p-u)\).
We assumed \(h(x+y) \leqslant k\) hence \(h(x+y) = f(p-u-v)\). Since \(h(x) = f(p-u)\), we have at last \(h(x+y) \neq
h(x)\).
\item If \(u+v \geqslant p\), then \(x+y = (\alpha+\beta-1) - (u+v-p) \) with \(u+v-p \in [\![0,p-1]\!] \).
We assumed \(h(x+y) \leqslant k \) hence \(h(x+y) = f( p- (p-u-v)) = f(p-u + p-v)\). Since \(f(p-u+p-v) \neq f(p-u)\),
we get \(h(x+y) \neq h(x)\).
\end{itemize} 
  
We now assume \(h(x) > k\). Then \(h(x) = k + g(\alpha) = k + g(\beta) = h(y)\), hence \(g(\alpha) = g(\beta)\). 
We have the two same cases as before.

\begin{itemize}
\item If \(u+v < p\), then \(x+y = (\alpha+\beta) - (u+v) \) with \(u+v \in [\![0,p-1]\!] \).
We assume \(h(x+y) > k\) otherwise the expected result is trivial.
Since \(g(\alpha) = g(\beta)\), the sum-free condition garanties \(g(\alpha) \neq g(\alpha+\beta)\), 
thus \(h(x+y) = k + g(\alpha + \beta) \neq k + g(\alpha) = h(x)\).
\item If \(u+v \geqslant p\), then \(x+y = (\alpha+\beta-1) - (u+v-p) \) with \(u+v-p \in [\![0,p-1]\!] \).
Because of the assumption \(h(x) > k\), we necessarily have \(f(p-u) = k+1 = f(p-v)\). 
Then \(f(p-(u+v-p)) = f(p-u + p-v) \leqslant k \) with the sum-free condition on \(f\), 
hence \(h(x+y) = f(p-(u+v-p)) \) by construction of \(h\). Thus \(h(x+y) \leqslant k < h(x)\).
\end{itemize}

\begin{definition}
A SF-template with \(n\) colors is said to be symmetric if the partition in \(n\) sum-free subsets derived (with the additive constant) from this template is symmetric. 
A sum-free partition \(A_1, ..., A_n\) of \([\![1, p]\!]\) is said to be symmetric if for all \( x \in [\![1, p]\!]\), \(x\) and \(p + 1 - x\) belong to the same subset 
(except if \(x = p + 1 - x\)).
\end{definition}

Using a SAT solver, we exhibited SF-templates, hence providing lower bound on \(S^+\) and inequalities 
of the type \(S(n+k) \geqslant a S(n) + b\). We have sought templates providing the greatest value of 
\((a, b)\) (for the lexicographic order). When the number of colors excceeded 5,in order to reduce the search space we 
looked for symmetric SF-templates, we assumed that the special color was the last color to appear and we constrained 
the \(m_c\)'s out of being too small. Further details about the encoding as a SAT problem can be found in the
\hyperref[SAT]{SAT section}. \\

Here are the best inequalities on Schur numbers so far (the templates corresponding to the third, fourth and fifth 
inequalities can be found in the appendix):
\[ S(n+1) \geqslant 3S(n) + 1 \]
\[ S(n+2) \geqslant 9S(n) + 4 \]
\[ S(n+3) \geqslant 33S(n) + 6 \]
\[ S(n+4) \geqslant 111S(n) + 43 \]
\[ S(n+5) \geqslant 380S(n) + 148 \]
\[ S(n+6) \geqslant 1140S(n) + 528 \]

The first inequality comes from the original Schur's paper \cite{Schur1917}. The second one is due to
Abott \cite{AbbottHanson}
and the third one to Rowley \cite{RowleyRamsey}. The other ones are new. \\

The first 3 inequalities are optimal. The fourth one is optimal among symmetric SF-templates whose special color is 
the last in the order of apparition (and with a multiplicative factor less than or equal to 118). The fifth one is most 
likely not optimal but should not be too far from the optimal SF-template. 
Finally, the sixth one is obtained by combining (see below) the SF-template of length 380 and the one of length 3. Although we 
could not find a better SF-template with 7 colors, this one definetely very far from the optimal value. One may try to seek better 
templates by constraining less the search space and by using a Monte-Carlo method, as in \cite{Bouzy2015AnAP}. 
This could be the suject of a future work.\\

We also have a similar theorem where only \(S^+\) is involved.

\begin{theorem}
	Let \((n,k), (p,q) \in (\mathbb{N}^*)^2\). If there exists a \(SF\)-template of \(k+1\) colors and lenght \(p\),
	and \(SF\)-template of \(n\) color and lenght \(q\), then there exists \(SF\)-template of \((n+k)\) and lenght \(pq\).
\end{theorem}

And the associated inequality :

\begin{corollary}
	Let \(n, k \in \mathbb{N}^*\), we have \\
	\[ S^+(n+k) \geqslant S^+(k+1)S^+(n) \]
\end{corollary}

\textsc{Proof :} The idea is the same as in the previous theorem. The only difference is the \(SF\) property inherited 
from the second \(SF\)-template.



\subsection{New lower bounds for Schur numbers}

The previous inequalities give new lower bounds for \(S(n)\) for
\( n \geqslant 9 \). We compute the lower
bounds for \( n \in [\![8,15]\!] \) using the four different inequalities, please notice that the best values for \( n
=8\) and \(n = 13\) were obtained thanks to the first one, found by Rowley. The best lower bounds are highlighted.\\
\\
\begin{center}
\begin{tabular}{|*{5}{c|}}
    \hline
	\(n\) & 8 & 9 & 10 & 11 \\
	\hline
	\(33S(n-3) + 6 \) & \cellcolor{yellow} 5286 & 17694 & 55446 & 174444\\
	\hline
	\(111S(n-4) + 43 \) & 4927 & \cellcolor{yellow} 17803 & 59539 & 186523\\
	\hline
	\(380S(n-5) + 148 \) & 5088 & 16868 & \cellcolor{yellow} 60948 & \cellcolor{yellow} 203828 \\
	\hline
	\(1140S(n-6) + 528 \) & 5088 & 15348 & 50688 & 182928\\
	\hline
	\hline
	\(n\) & 12 & 13 & 14 & 15 \\
	\hline
	\(33S(n-3) + 6 \) & 587505 & \cellcolor{yellow} 2011290 & 6726330 & 21072090\\
	\hline
	\(111S(n-4) + 43 \) & 586789 & 1976176 & 6765271 & 22624951 \\
	\hline
\(380S(n-5) + 148 \) & \cellcolor{yellow} 638548 & 2008828 & \cellcolor{yellow} 6765288 & \cellcolor{yellow} 23160388 \\\hline
	\(1140S(n-6) + 528 \) & 611568 & 1915728 & 6026568 & 20295948 \\
	\hline
\end{tabular}
\end{center}
Except for 8, 9 and 13, the best lower bounds are obtained thanks to
the third inequality \( S(n+5) \geqslant 380S(n) + 148\). The table
doesn't go any further, but the same inequality allows to improve the
lower bounds for every \( n \geqslant 15 \).

\begin{corollary}
The growth rate for Schur numbers (and Ramsey numbers \(R_n(3)\))  satisfies \(\gamma \geqslant \sqrt[5]{380} \approx 3.28 \).
\end{corollary}
\textsc{Proof :} It is a mere consequence of the inequality \( S(n+5) \geqslant 380S(n) + 148\). As for Ramsey's
numbers growth rate, a lower bound can be found using Schur's one, thanks to \(S(n) \leqslant R_n(3)-2 \)
(see \cite{Schur1917}).
