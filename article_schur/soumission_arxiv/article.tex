\documentclass{article}


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{dsfont}
\usepackage{MyMnSymbol}

\usepackage[english]{babel}
\usepackage[hyphens]{url}
\usepackage{hyperref}
\hypersetup{hidelinks}
\usepackage[utf8]{inputenc}
\usepackage{siunitx}
\usepackage{float}

\usepackage[table]{xcolor}
\usepackage{multirow}
\usepackage{nicematrix}

\addtolength{\textheight}{108pt} \addtolength{\topmargin}{-60pt}
\oddsidemargin=-6pt \addtolength{\textwidth}{120pt}
\righthyphenmin=2

\renewcommand{\qedsymbol}{\(\square\)}

\newtheorem{definition}{Definition}[section]
\newtheorem{notation}[definition]{Notation}
\newtheorem{theorem}[definition]{Theorem}
\newtheorem{computational theorem}[definition]{Computational Theorem}
\newtheorem{corollary}[definition]{Corollary}
\newtheorem{remark}[definition]{Remark}
\newtheorem{proposition}[definition]{Proposition}

\newcommand{\WS}{\mathit{WS}}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}


\title{New lower bounds for Schur and weak Schur numbers}

\author{
Romain Ageron\textsuperscript{a,1}\and
Paul Casteras\textsuperscript{a,1}\and
Thibaut Pellerin\textsuperscript{a,1}\and
Yann Portella\textsuperscript{a,1}\and
Arpad Rimmel\textsuperscript{b,2}\and
Joanna Tomasik\textsuperscript{b,2,}*
}

\date{
	\textsuperscript{a}CentraleSup\'elec, Universit\'e{} Paris-Saclay, 91 190, Gif-sur-Yvette, France\\
	\textsuperscript{b}LISN, CentraleSup\'elec, Universit\'e{} Paris-Saclay, 91 405, Orsay, France\\[2ex]
	\today
}


\begin{document}

\maketitle

\blfootnote{\textsuperscript{1}These authors contributed equally.}
\blfootnote{\textsuperscript{2}These authors supervised the work of the main authors.}
\blfootnote{*Corresponding author (\tt{joanna.tomasik@centralesupelec.fr})}
\vspace{-5ex}

\begin{abstract}
This article provides new lower bounds for both Schur and weak Schur numbers by exploiting a "template"-based approach.
The concept of "template" is also generalized to weak Schur numbers. Finding new templates leads to explicit partitions
improving lower bounds as well as the growth rate for Schur numbers, weak Schur numbers, and multicolor Ramsey numbers \(R_n(3)\).
The new lower bounds include \(S(9) \geqslant 17\,803\), \(S(10) \geqslant 60\,948\), \(\WS(6) \geqslant 646\),
\(\WS (9) \geqslant 22\,536\) and \(\WS (10) \geqslant 71\,256 \).
\end{abstract}

Keywords: Schur number, Weak Schur number, Ramsey theory, Sum-free partition

MSC 2020: 05D10, 05A17, 11B75, 11P81


\section{Introduction}

We are interested in partitioning the set of integers \(\{1, ..., p\}\) into \(n\) subsets such that there is no
subset containing three integers \(x\), \(y\) and \(z\) verifying \(x + y = z\). We say these subsets are
\textit{sum-free}. If we lessen the above constraint by only considering integers \(x,y\) such that \(x \neq y\), we say the subsets are \textit{weakly sum-free}. The
greatest \(p\) for which there is a partition into \(n\) sum-free subsets is called the \(n^{\text{th}}\) Schur
number and is denoted \(S(n)\) \cite{Schur1917}. Likewise for weakly sum-free partitions we define \(\WS(n)\)
the \(n^{\text{th}}\) weak Schur number \cite{Irving1973}. Values of \(S(n)\) and \(\WS(n)\) are known for small \(n\) only.


\subsection{State of the art}

Up to recently, the most efficient generic construction for Schur numbers was given by Abbott and Hanson
\cite{AbbottHanson} in 1972 with a recursive construction. It gave the best lower bounds for all sufficiently large
numbers. No equivalent was known for weak Schur numbers and, as a result, the best known partitions for large
weak Schur numbers did not use the \textit{weakly} sum-free property.

\par
As for smaller weak Schur numbers, the best lower bounds were obtained by computations. Eliahou
\cite{EliahouBook}, Bouzy \cite{Bouzy2015AnAP} and Rafilipojaona \cite{Rafilipojaona} improved the lower
bounds with Monte-Carlo methods. This was the main approach during the past decade.

\par
In 2020, Rowley introduced the notion of templates for Schur and Ramsey numbers \cite{RowleyRamsey} which
generalizes Abbott and Hanson's construction and produces new lower bounds (and inequalities) for Schur numbers.
He also provided two inequalities for weak Schur numbers \cite{RowleyWS}. Besides, these two inequalities do use the \textit{weakly} sum-free property.

\par The hereunder tables recap the lower bounds for Schur and weak Schur numbers, respectively. Gray cells
indicate the exact values.


\begin{table}[H]
{\footnotesize
	\caption{Comparison of lower bounds for Schur numbers}\label{table:1}
\begin{center}
	\begin{small}
	\setlength{\tabcolsep}{3pt}
	\renewcommand{\arraystretch}{1.2}
	\begin{NiceTabular}{*{13}{c}}[vlines]
	\CodeBefore
		\cellcolor{gray!40}{2-2}
		\cellcolor{gray!40}{2-3}
		\cellcolor{gray!40}{2-4}
		\cellcolor{gray!40}{2-5}
		\cellcolor{gray!40}{2-6}
		\cellcolor{gray!40}{3-2}
		\cellcolor{gray!40}{3-3}
		\cellcolor{gray!40}{3-4}
		\cellcolor{gray!40}{3-5}
		\cellcolor{gray!40}{3-6}
	\Body
		\hline
		\(n\) & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 \\
		\hline
		\Block{2-1}{State of the art} & 1 & 4 & 13 & 44 & 160 & 536 & 1\,696 & 5\,286 & 17\,694 & 60\,320 & 201\,696 & 637\,856 \\
		& & & & & \cite{Heule2017} & \cite{Fredricksen} & \cite{rowley2021improved} & \cite{RowleyRamsey} & \cite{RowleyRamsey} &
			\cite{RowleyRamsey} & \cite{RowleyRamsey} & \cite{RowleyRamsey} \\
		\hline
		\hyperref[Schur]{\textbf{Our results}}  & & & & & & & & & \textbf{17\,803} & \textbf{60\,948} & \textbf{203\,828} & \textbf{644\,628} \\
		\hline
	\end{NiceTabular}
	\end{small}
\end{center}
}
\end{table}


\begin{table}[H]
{\footnotesize
	\caption{Comparison of lower bounds for weak Schur numbers}\label{table:2}
\begin{center}
	\begin{small}
	\setlength{\tabcolsep}{3pt}
	\renewcommand{\arraystretch}{1.2}
	\begin{NiceTabular}{*{13}{c}}[vlines]
	\CodeBefore
		\cellcolor{gray!40}{2-2}
		\cellcolor{gray!40}{2-3}
		\cellcolor{gray!40}{2-4}
		\cellcolor{gray!40}{2-5}
		\cellcolor{gray!40}{3-2}
		\cellcolor{gray!40}{3-3}
		\cellcolor{gray!40}{3-4}
		\cellcolor{gray!40}{3-5}
	\Body
		\hline
		\(n\) & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 \\
		\hline
		\Block{2-1}{State of the art} & 2 & 8 & 23 & 66 & 196 & 642 & 2\,146 & 6\,976 & 22\,056 & 70\,778 & 241\,282 & 806\,786 \\
		& & & & & \cite{ELIAHOU2012175} &\cite{RowleyWS} & \cite{RowleyWS} & \cite{RowleyWS} & \cite{RowleyWS} &
			\cite{RowleyWS} & \cite{RowleyWS} & \cite{RowleyWS} \\
		\hline
		\hyperref[WeakSchur]{\textbf{Our results}}& & & & & & \textbf{646} & & & \textbf{22\,536} & \textbf{71\,256} & \textbf{243\,794} & \textbf{815\,314} \\
		\hline
	\end{NiceTabular}
	\end{small}
\end{center}
}
\end{table}


\subsection{Organization of this article}

Our main contribution is a generalization of the concept of template to weak Schur numbers. Our templates
provide new lower bounds (and inequalities) for weak Schur numbers. As a special case, our construction also includes
a construction similar to Abbott and Hanson's \cite{AbbottHanson}, but for \textit{weak} Schur numbers this time.

\par
In Section \ref{Schur}, we explain Rowley's template-based construction for
Schur numbers. Then, we give new templates, thus providing new lowers bounds and inequalities as well as
showing that the growth rates for both Schur and Ramsey numbers \(R_n(3)\) exceed 3.28.

\par
In Section \ref{WeakSchur}, we generalize the concept of template to weak Schur numbers
and provide new lower bounds for weak Schur numbers. Then, we use a different approach and give a new
lower bound for \(\WS(6)\).

\par
Now, we introduce notations and definitions used throughout this article.

\subsection{Definitions and notations}

We start by defining sum-free and weakly sum-free subsets to introduce regular and weak Schur numbers.
The set of positive natural numbers is denoted by \(\mathbb{N}^* =\mathbb{N} \backslash \{0\}\).

\begin{definition}
A subset \(A\) of \(\mathbb{N}\) is said to be \textit{sum-free} if
\[ \forall (a,b) \in A^2 \text{, } a+b \notin A.\]
\end{definition}

\begin{definition}
A subset \(B\) of \(\mathbb{N}\) is said to be \textit{weakly sum-free} if
\[ \forall (a,b) \in B^2 \text{, } a \neq b \Longrightarrow a+b \notin B.\]
\end{definition}

Let us notice that a sum-free subset is also weakly sum-free, hence justifying the name of \textit{weakly} sum-free
subsets. Given \(p\) and \(n\) two integers, we are interested in partitioning the set of integers \(\{1, 2, ..., p\}\),
denoted by \([\![1,p]\!]\), into \(n\) (weakly) sum-free subsets.

\par
Schur proved \cite{Schur1917} that given a number of subsets \(n\), there is a value of \(p\)
such that \([\![1,q]\!]\) cannot be partioned into \(n\) sum-free subsets for \(q \geqslant p\). A similar
property holds for weakly sum-free subsets \cite{Irving1973}. These observations lead to the following definitions
written for \(n \in \mathbb{N}^*\):

\begin{definition}
There is a largest integer denoted by \(S(n)\) such that \([\![1, S(n)]\!]\) can be
 partitioned into \(n\) sum-free subsets. \(S(n)\) is called the \textit{\(n\)\textsuperscript{th} Schur number}.
\end{definition}

\begin{definition}
There is a largest integer denoted by \(\WS (n)\) such that \([\![1, \WS (n)]\!]\)
can be partitioned into \(n\) weakly sum-free subsets. \(\WS(n)\) is called the \(n\)\textsuperscript{th} weak Schur
number.
\end{definition}

Subsets of an \(n\)-partition are denoted \(A_1, ..., A_n\). The smallest element of \(A_i\) is denoted
\(m_i = \min(A_i)\). By ordering the subsets, we mean assuming that \(m_1 < ... < m_n\). We will make clear in the text
when we use a subset ordering.

A partition may be seen as a number coloring.

\begin{definition}
The coloring associated to a partition \(A_1, ..., A_n\) of
\([\![1, p]\!]\) is the function \(f\) such that \(\forall x \in [\![1, p]\!], x \in A_{f(x)}\). Likewise, the partition associated to
a coloring \(f\) of \([\![1, p]\!]\) with \(n\) colors is \(\forall c \in [\![1, n]\!], A_c = f^{-1}(c)\).
\end{definition}


\section{Templates for Schur numbers}
\label{Schur}

We use Rowley's template-based constructions \cite{RowleyRamsey} for Schur 
numbers. To improve lower bounds for Schur and Ramsey numbers, he has introduced special sum-free 
partitions verifying some additional properties which can be extended using a method generalizing Abbott and 
Hanson's construction \cite{AbbottHanson}. He called these partitions "templates", and we keep this nomination. 
Then, we propose new templates and use them to produce new lower bounds for Schur numbers.

\subsection{Definition of \( [\![ 1, S^+ ]\!] \)}

We begin by introducing \textit{S-templates}, standing for \textit{"Schur templates"}. The idea is to consider the first line
of \hyperref[figure:1]{Figure 1} not as a combination of two blocs, like in \cite{AbbottHanson} but as a whole, single construction. 
An S-template is then defined as a new object playing the role of the first line but with less, yet sufficient, 
constraints which allow for an expansion of the partition using a sum-free partition.

\begin{definition}
Let \((p,n) \in (\mathbb{N}^*)^2\). An S-template with \(n\) colors is defined as a partition of 
\([\![1,p]\!]\) into \(n\) sum-free subsets \(A_1, A_2, ..., A_n\) verifying for all subsets but \(A_n\)
\begin{equation}
\label{eq:constemp}
\forall (x,y) \in A_i^2, x+y > p
\Longrightarrow x+y-p \notin A_i.
\end{equation}
The integer \(p\) is called the \textit{width} of the template.
\end{definition}

Here \(n\) can be seen as a "special" color in the sense that it is not constrained by Assertion (\ref{eq:constemp}).
Number \(p\) is necessarily colored with color \(n\). However, note that \(n\) is not necessarily the last color by order of appearance.


\begin{proposition}
	Let \(n \in [\![2, +\infty[\![\). We define \(S^+(n)\) as the greatest integer \(w\) such that there is an S-template with 
	width \(w\) and \(n\) colors. 
	\(S^+(n)\) is well defined and verifies
	\[
	2S(n-1)+1 \leqslant S^+(n) \leqslant S(n).
	\]
\end{proposition}

\begin{proof}
The upper bound comes from the fact that an S-template with width \(p\) and \(n\) colors is also a sum-free \(n\)-partition 
of \([\![1, p]\!]\). The lower bound comes from Abbott and Hanson's construction \cite{AbbottHanson}. \\
\end{proof}


\subsection{Construction of Schur partitions using S-templates}

We start by reminding the explicit construction of a sum-free partition with the use of an S-template and a sum-free partition. 
We rephrase in terms of Schur numbers this construction stated by Rowley in the context of Ramsey numbers \cite{RowleyRamsey}.

\begin{theorem}
\label{thm:Stemp}
	Let \((p,k), (q,n) \in (\mathbb{N}^*)^2\). If there are an \(S\)-template with width \(q\) and \(n+1\) colors 
	and a sum-free \(k\)-partition of \([\![1,p]\!]\) then there is a partition of \([\![1,pq+m_{n+1}
	-1]\!]\) into \(n+k\) sum-free subsets. \(m_{n+1}\) denotes the minimum element colored with the special color in the \(S\)-template.
\end{theorem}

The idea lying beneath this theorem is similar to Abbott and Hanson's construction \cite{AbbottHanson}. First, they
put the integers from \([\![1,S(k)(2S(n)+1)+S(n)]\!]\) in a table with width \(2S(n)+1\) and height \(S(k)+1\) and they 
numbered both the rows and the columns, starting from one upwards. Then, they 
extended a sum-free partition vertically by repeating it. Next, they used another sum-free partition to color the other half according 
to the line number, as in \hyperref[figure:1]{Figure 1}. We give an example for \(p = 4\), 
\(q = 9\), \(n = 2\) and \(k = 2\) showing that \(S(2 + 2) \geqslant S(2) \left(2 S(2) + 1\right) + S(2)\), both with Abbott and 
Hanson's construction (\hyperref[figure:1]{Figure 1}) and with an S-template which is not included in Abbott and Hanson's construction 
(\hyperref[figure:2]{Figure 2}). In both cases, the special color is grey.

\begin{figure}[H]
{\footnotesize
	\caption{Visualisation of an Abbott and Hanson construction}\label{figure:1}}
\begin{center}

{\footnotesize\textbf{Abbott and Hanson's construction}}
\vspace{1.7ex}

\renewcommand{\arraystretch}{1.5}
\setlength{\tabcolsep}{1.2ex}
\begin{NiceTabular}{|*{9}{c|}}[corners=SE,standard-cline,hlines]
\CodeBefore
	\cellcolor{red}{1-1}
	\cellcolor{green}{1-2}
	\cellcolor{green}{1-3}
	\cellcolor{red}{1-4}
	\cellcolor{cyan}{1-5}
	\cellcolor{cyan}{1-6}
	\cellcolor{cyan}{1-7}
	\cellcolor{cyan}{1-8}
	\cellcolor{cyan}{1-9}
	\cellcolor{red}{2-1}
	\cellcolor{green}{2-2}
	\cellcolor{green}{2-3}
	\cellcolor{red}{2-4}
	\cellcolor{yellow}{2-5}
	\cellcolor{yellow}{2-6}
	\cellcolor{yellow}{2-7}
	\cellcolor{yellow}{2-8}
	\cellcolor{yellow}{2-9}
	\cellcolor{red}{3-1}
	\cellcolor{green}{3-2}
	\cellcolor{green}{3-3}
	\cellcolor{red}{3-4}
	\cellcolor{yellow}{3-5}
	\cellcolor{yellow}{3-6}
	\cellcolor{yellow}{3-7}
	\cellcolor{yellow}{3-8}
	\cellcolor{yellow}{3-9}
	\cellcolor{red}{4-1}
	\cellcolor{green}{4-2}
	\cellcolor{green}{4-3}
	\cellcolor{red}{4-4}
	\cellcolor{cyan}{4-5}
	\cellcolor{cyan}{4-6}
	\cellcolor{cyan}{4-7}
	\cellcolor{cyan}{4-8}
	\cellcolor{cyan}{4-9}
	\cellcolor{red}{5-1}
	\cellcolor{green}{5-2}
	\cellcolor{green}{5-3}
	\cellcolor{red}{5-4}
\Body
	1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\
	10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 \\
	19 & 20 & 21 & 22 & 23 & 24 & 25 & 26 & 27 \\
	28 & 29 & 30 & 31 & 32 & 33 & 34 & 35 & 36 \\
	37 & 38 & 39 & 40 \\
\end{NiceTabular}

\vspace{1ex}
\setlength{\tabcolsep}{2ex}

\begin{tabular}{c c}
	{\footnotesize\textbf{Corresponding S-template}} & {\footnotesize\textbf{Corresponding sum-free partition}} \\
	\setlength{\tabcolsep}{1.5ex}
	\begin{NiceTabular}{|*{9}{c|}}[standard-cline,hlines]
	\CodeBefore 
		\cellcolor{red}{1-1}
		\cellcolor{green}{1-2}
		\cellcolor{green}{1-3}
		\cellcolor{red}{1-4}
		\cellcolor{gray!40}{1-5}
		\cellcolor{gray!40}{1-6}
		\cellcolor{gray!40}{1-7}
		\cellcolor{gray!40}{1-8}
		\cellcolor{gray!40}{1-9}
	\Body
		1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\
	\end{NiceTabular} &
	\setlength{\tabcolsep}{1.5ex}
	\begin{NiceTabular}{|*{4}{c|}}[standard-cline,hlines]
	\CodeBefore
		\cellcolor{cyan}{1-1}
		\cellcolor{yellow}{1-2}
		\cellcolor{yellow}{1-3}
		\cellcolor{cyan}{1-4}
	\Body
		1 & 2 & 3 & 4 \\
	\end{NiceTabular}
\end{tabular}

\setlength{\tabcolsep}{6pt}
\end{center}
\end{figure}
In the general construction with S-templates, the special color may not paint consecutive 
numbers any longer. However, the special color is still replaced by the colors of the sum-free partition according to the 
line number and the other colors are still vertically extended.

\begin{figure}[H]
{\footnotesize
	\caption{Visualisation of a template-based construction}\label{figure:2}}
\begin{center}
{\footnotesize\textbf{S-template construction}}
\setlength{\tabcolsep}{1.2ex}
\renewcommand{\arraystretch}{1.5}

\vspace{1.7ex}
\begin{NiceTabular}{|*{9}{c|}}[corners=SE,standard-cline,hlines]
\CodeBefore
	\cellcolor{red}{1-1}
	\cellcolor{green}{1-2}
	\cellcolor{green}{1-3}
	\cellcolor{red}{1-4}
	\cellcolor{cyan}{1-5}
	\cellcolor{cyan}{1-6}
	\cellcolor{red}{1-7}
	\cellcolor{cyan}{1-8}
	\cellcolor{cyan}{1-9}
	\cellcolor{red}{2-1}
	\cellcolor{green}{2-2}
	\cellcolor{green}{2-3}
	\cellcolor{red}{2-4}
	\cellcolor{yellow}{2-5}
	\cellcolor{yellow}{2-6}
	\cellcolor{red}{2-7}
	\cellcolor{yellow}{2-8}
	\cellcolor{yellow}{2-9}
	\cellcolor{red}{3-1}
	\cellcolor{green}{3-2}
	\cellcolor{green}{3-3}
	\cellcolor{red}{3-4}
	\cellcolor{yellow}{3-5}
	\cellcolor{yellow}{3-6}
	\cellcolor{red}{3-7}
	\cellcolor{yellow}{3-8}
	\cellcolor{yellow}{3-9}
	\cellcolor{red}{4-1}
	\cellcolor{green}{4-2}
	\cellcolor{green}{4-3}
	\cellcolor{red}{4-4}
	\cellcolor{cyan}{4-5}
	\cellcolor{cyan}{4-6}
	\cellcolor{red}{4-7}
	\cellcolor{cyan}{4-8}
	\cellcolor{cyan}{4-9}
	\cellcolor{red}{5-1}
	\cellcolor{green}{5-2}
	\cellcolor{green}{5-3}
	\cellcolor{red}{5-4}
\Body
	1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\
	10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 \\
	19 & 20 & 21 & 22 & 23 & 24 & 25 & 26 & 27 \\
	28 & 29 & 30 & 31 & 32 & 33 & 34 & 35 & 36 \\
	37 & 38 & 39 & 40 \\
\end{NiceTabular}

\vspace{1ex}
\setlength{\tabcolsep}{1.5ex}

\begin{tabular}{c c}
	{\footnotesize\textbf{Corresponding S-template}} & {\footnotesize\textbf{Corresponding sum-free partition}} \\
	\setlength{\tabcolsep}{1.5ex}
	\begin{NiceTabular}{|*{9}{c|}}[standard-cline,hlines]
	\CodeBefore 
		\cellcolor{red}{1-1}
		\cellcolor{green}{1-2}
		\cellcolor{green}{1-3}
		\cellcolor{red}{1-4}
		\cellcolor{gray!40}{1-5}
		\cellcolor{gray!40}{1-6}
		\cellcolor{red}{1-7}
		\cellcolor{gray!40}{1-8}
		\cellcolor{gray!40}{1-9}
	\Body
		1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\
	\end{NiceTabular} &
	\setlength{\tabcolsep}{1.5ex}
	\begin{NiceTabular}{|*{4}{c|}}[standard-cline,hlines]
	\CodeBefore
		\cellcolor{cyan}{1-1}
		\cellcolor{yellow}{1-2}
		\cellcolor{yellow}{1-3}
		\cellcolor{cyan}{1-4}
	\Body
		1 & 2 & 3 & 4 \\
	\end{NiceTabular}
\end{tabular}

\setlength{\tabcolsep}{6pt}
\end{center}
\end{figure}


Now, we prove Theorem \ref{thm:Stemp}.

\begin{proof}
	Let \(f\) and \(g\) be colorings associated to the S-template with width \(q\) and the sum-free partition of 
	\([\![1,p]\!]\), respectively: \(f : [\![1,q]\!] \longrightarrow [\![1,n+1]\!]\) and 
	\(g : [\![1,p]\!] \longrightarrow [\![1,k]\!]\).
	
	\par
	NB: In the following three predicates, the conditions \(x + y \leqslant q\)  and \(x + y \leqslant p\) are omitted for readability.
	\par
	The sum-free condition is expressed as:
	\[\forall (x,y) \in [\![1,q]\!]^2, f(x) = f(y) \Longrightarrow f(x+y) \neq f(x),\]
	\[\forall (x,y) \in [\![1,p]\!]^2, g(x) = g(y) \Longrightarrow g(x+y) \neq g(x).\]
	
	The  additional constraint for the S-template is:
	\[
	\forall (x,y) \in [\![1,q]\!]^2, \left\{
	\begin{array}{l}
		f(x) = f(y) \leqslant n \\
		x + y > q
	\end{array}
	\right. \Longrightarrow f(x+y-q) \neq f(x).
	\]
	
	For \(x \in [\![1,pq+m_{n+1}-1]\!]\), we write \(x = (\alpha - 1) q + u\) for certain integers \(\alpha \in \mathbb{N}^*\) 
	and \(u \in [\![1,q]\!]\). Obviously, this decomposition unique. Coefficients \(\alpha\) and \(u\) may be interpreted as line 
	and column coordinates of \(x\) in the template. We define a coloring \(h\) of \([\![1,pq+m_{n+1}-1]\!]\) using \( [\![1,n+k]\!]\) colors:
	\[
	\begin{array}{c c c l}
		h : & [\![1,pq+m_{n+1}-1]\!] & \longrightarrow & [\![1,n+k]\!], \\
		& x & \longmapsto & 
		\left\{ \begin{array}{l l}
			f(u), & \text{if}~f(u) \leqslant n, \\
			n + g(\alpha), & \text{if}~f(u) = n + 1. \\
		\end{array} \right.
	\end{array}
	\]
	
	Function \(h\) is well-defined since, by definition of \(m_{n+1}\), \(\forall x \in [\![p q + 1, p q + m_{n + 1} - 1 ]\!], f(u) 
	\leqslant n\) and therefore \(\forall x \in [\![1,pq+m_{n+1}-1]\!], f(u) = n + 1 \implies \alpha \in [\![1, p]\!]\).
	
	\par
	Now, we prove that \(h\) is a sum-free coloring. Let \(x,y \in [\![1,pq + m_{n+1}-1]\!]\) such that \(h(x) = h(y)\) 
	and \(x+y \leqslant pq+m_{n+1}-1\). We claim that \(h(x+y) \neq h(x)\). We write \(x = (\alpha - 1) q + u\) and 
	\(y = (\beta - 1) q + v\) where \(\alpha, \beta \in \mathbb{Z}\) and \(u, v \in [\![1,q]\!]\). Two cases are to be
	distinguished according to the value of \(h(x)\). \\
	
	\noindent \underline{\textbf{Case 1:} \(h(x) \leqslant n\)}
	\par
	Let us assume that \(h(x+y) \leqslant n\), otherwise \(h(x + y) \neq h(x)\) obviously holds. By definition of function 
	\(h\) and given that \(h(u) = h(v)\), we conclude \(f(u) = f(v)\). Two cases are to be distinguished according to the value of \(x + y\).
	
	\begin{itemize}
	\item If \(u + v > q\), we write \(w = u + v - q \in [\![1, q]\!]\). Consequently \(x + y = (\alpha + \beta - 1) q + w\). By definition, 
		\(h(x + y) = f(w)\). Given that \(f(u) = f(v) \leqslant n\), the  additional constraint on \(f\) implies \(f(w) 
		\neq f(u)\), that is \(h(x + y) \neq h(x)\).
	\item If \(u + v \leqslant q\), we write \(w = u + v \in [\![1, q]\!]\). Consequently \(x+y = (\alpha + \beta- 2) q + w\). By definition, 
		\(h(x + y) = f(w)\). Given that \(f(u) = f(v) \leqslant n\), the sum-free property of \(f\) implies \(f(w) \neq f(u)\), 
		that is \(h(x + y) \neq h(x)\).
	\end{itemize} 
	  
	\noindent \underline{\textbf{Case 2:} \(h(x) \geqslant n + 1\)}
	\par
	Now we have \(h(x) = n + g(\alpha) = 
	n + g(\beta) = h(y)\), hence \(g(\alpha) = g(\beta)\). As above, we distinguish between two cases according 
	to the value of \(x + y\).
	
	\begin{itemize}
	\item \begin{sloppypar}
		If \(u + v > q\), write \(w = u + v - q \in [\![1, q]\!]\). Then \(x + y = (\alpha + \beta - 1) q + w\). Assume that 
		\({h(x+y) \geqslant n + 1}\),  otherwise \(h(x + y) \neq h(x)\) obviously holds. By definition, \({h(x + y) = n + g(\alpha + 
		\beta)}\). Given that \(g(\alpha) = g(\beta)\), the sum-free property of \(g\) implies \(g(\alpha + \beta) 
		\neq g(\alpha)\) that is \(h(x + y) \neq h(x)\).
		\end{sloppypar}
	\item  If \(u + v \leqslant q\), write \(w = u + v \in [\![1, q]\!]\). Then \(x+y = (\alpha + \beta- 2) q + w\). The sum-free 
		property of \(f\) implies \(f(w) \neq f(u)\). Therefore \(f(w) \leqslant n\) and thus \(h(x + y) \leqslant n\). In particular,
		given that \(h(x) \geqslant n + 1\), \(h(x + y) \neq h(x)\).
	\end{itemize}
\end{proof}

Setting \(q = S^+(n+1)\) and \(p = S(k)\) in Theorem \ref{thm:Stemp} yields the following corollary.

\begin{corollary}
\label{cor:ineqS}
	Let \(n, k \in \mathbb{N}^*\). Then
	\[ S(n+k) \geqslant S^+(n+1)S(k) + m_{n+1} - 1.\]
\end{corollary}

The following proposition may improve the additive constant of Corollary \ref{cor:ineqS}.

\begin{proposition}
\label{prop:rafStemp}
Let \((q, n) \in \left(\mathbb{N}^* \right)^2\) and let \(f\) be a coloring associated to an S-template with width \(q\) and \(n+1\) 
colors. Let \(b \in \mathbb{N}\) and assume there is a coloring \(g\) of 
\([\![1, b]\!]\) with \(n+1\) colors such that:
	
\begin{itemize}
\item \(\forall (x, y) \in [\![1, q]\!]^2, \left\{
	\begin{array}{l}
		f(x) = f(y) \\
		(x + y) \mod q \leqslant b
	\end{array}
	\right. \implies g((x + y) \mod q) \neq f(x)\),
\item \(\forall (x, y) \in [\![1, q]\!] \times  [\![1, b]\!],  \left\{
	\begin{array}{l}
		f(x) = g(y) \\
		x + y \leqslant b
	\end{array}
	\right. \implies g(x + y) \neq f(x)\).
\end{itemize}
	
Then, for every \(n \in \mathbb{N}^*\), by using on the last row the coloring \(x \longmapsto g(x - q S(n))\), we have
\[ S(n+k) \geqslant q S(k) + b.\]
\end{proposition}
This proposition corresponds to the fact that the hypotheses made on the coloring of the last row can be weakened because 
the constraints in the definition of an S-template prevent a number from: 
\begin{itemize}
\item being the sum of two of numbers of its own color. 
\item creating a sum in its own color. 
\end{itemize}
The later is not always relevant on the last row given that it is not completely filled.
As a result, we can change the coloring on \([\![ q S(k) + 1,  q S(k) + b]\!]\) (the last row) to extend the previous partitions.
\newline

There is a construction theorem for S-templates as well.

\begin{theorem}
	Let \((p,k), (q,n) \in (\mathbb{N}^*)^2\). If there are an S-template with width \(q\) and \(n+1\) colors,
	and an S-template with width \(p\) and \(k\) colors, then there also is an S-template with width \(pq\) and \((n+k)\) 
	colors.
\end{theorem}

\begin{proof}
The idea is the same as in the Theorem \ref{thm:Stemp}. The only difference is the S-template property inherited 
from the second S-template. \\
\end{proof}
	
The inequality associated with this theorem is given by:
	
\begin{corollary}
	Let \(n, k \in \mathbb{N}^*\). Then
	\[ S^+(n+k) \geqslant S^+(n+1)S^+(k).\]
\end{corollary}


\subsection{New lower bounds for Schur numbers}
\label{subsec:lowS}

We now give the inequalities corresponding to the current  best S-templates.

\begin{definition}
A sum-free partition \(A_1, ..., A_n\) of \([\![1, p]\!]\) is said to be symmetric if for all \( x \in [\![1, p]\!]\), 
\(x\) and \(p + 1 - x\) belong to the same subset (except if \(x = p + 1 - x\)).

An S-template with \(n\) colors is said to be symmetric if the sum-free \(n\)-partition derived 
from this template by applying the extension procedure of Theorem \ref{thm:Stemp} with a sum-free 
partition with length one is symmetric. 
\end{definition}

We produced S-templates using the lingeling SAT solver \cite{Lingeling2017}, hence providing lower bounds on 
\(S^+\) and inequalities of the type \(S(n+k) \geqslant a S(n) + b\). We sought templates providing us with 
the largest value of \((a, b)\) (in the lexicographic order). In order to reduce the search space when the number 
of colors exceeded five we only looked for symmetric S-templates, we assumed that the special color was the last 
color to appear and we constrained the \(m_c\)'s out of being too small. Details concerning the encoding as a SAT 
problem can be found in \cite{Heule2017}.

\par
The following six inequalities are given by the current best S-templates with \(n \leqslant 7\) colors.
\begin{align}
	S(n + 1) \geqslant &~3\,S(n)  + 1 \label{S(n+1)}\\
	S(n + 2) \geqslant &~9\,S(n)  + 4 \label{S(n+2)}\\
	S(n + 3) \geqslant &~33\,S(n) + 6 \label{S(n+3)}
\end{align}

Inequality (\ref{S(n+1)}) comes from  Schur's original article \cite{Schur1917}. Inequality (\ref{S(n+2)}) is due to
Abott and Hanson \cite{AbbottHanson} and inequality (\ref{S(n+3)}) to Rowley \cite{RowleyRamsey}. 
The three following inequalities are our result:

\begin{align}
	S(n + 4) \geqslant &~111\,S(n) + 43 \label{S(n+4)}\\
	S(n + 5) \geqslant &~380\,S(n) + 148 \label{S(n+5)}\\
	S(n + 6) \geqslant &~1\,160\,S(n) + 536 \label{S(n+6)}
\end{align}

\par The \hyperref[S-templates]{templates} corresponding to inequalities (\ref{S(n+3)}), (\ref{S(n+4)}), and 
(\ref{S(n+5)}) are listed in \ref{S-templates}.

\par
Inequalities (\ref{S(n+1)}), (\ref{S(n+2)}), and (\ref{S(n+3)}) cannot be further improved (with this definition of S-template). 
Inequality (\ref{S(n+4)}) cannot be further improved by only searching for symmetric S-templates whose special color is the 
last in the order of apparition (and with a multiplicative factor less than or equal to 118). Inequality (\ref{S(n+5)}) can most 
likely be further improved but the improvement probably will not be substantial. Finally, an S-template corresponding to inequality 
(\ref{S(n+6)}) was found by extending into a S-template the Schur 6-partition used in \cite{rowley2021improved} (owing to the 
size of this template, its interest is limited and since it can easily be derived from above mentioned partition, it is not given in 
\ref{S-templates}). Although we could not find a better S-template with seven colors, inequality (\ref{S(n+6)}) can definitely be 
improved by a wide margin.

\par
The previous inequalities give new lower bounds for \(S(n)\) for
\( n \geqslant 9 \). We compute the lower
bounds for \( n \in [\![8,15]\!] \) using the four different inequalities. The best lower bounds are highlighted.


\begin{table}[H]
{\footnotesize
	\caption{New lower bounds for \(S(n)\) with \( n \in [\![8,15]\!] \)}\label{LowerBoundsS}}
\begin{center}
\[
\begin{array}{c}
	\begin{NiceArray}{cwc{8ex}wc{10ex}wc{10ex}wc{11ex}}[hvlines]
	\CodeBefore
		\cellcolor{yellow}{2-2}
		\cellcolor{yellow}{3-3}
		\cellcolor{yellow}{4-4}
		\cellcolor{yellow}{4-5}
	\Body
		n & 8 & 9 & 10 & 11 \\
		33 \, S(n-3) + 6 & 5\,286 & 17\,694 & 55\,974 & 174\,444 \\
		111 \, S(n-4) + 43 & 4927 & 17\,803 & 59\,539 & 188\,299 \\
		380 \, S(n-5) + 148 & 5\,088 & 16\,868 & 60\,948 & 203\,828 \\
	\end{NiceArray}
	\\ \\
	\begin{NiceArray}{cwc{8ex}wc{10ex}wc{10ex}wc{11ex}}[hvlines]
	\CodeBefore
		\cellcolor{yellow}{2-3}
		\cellcolor{yellow}{4-2}
		\cellcolor{yellow}{4-4}
		\cellcolor{yellow}{4-5}
	\Body
		n & 12 & 13 & 14 & 15 \\
		33 \, S(n-3) + 6 & 587\,505 & 2\,011\,290 & 6\,726\,330 & 21\,272\,730 \\
		111 \, S(n-4) + 43 & 586\,789 & 1\,976\,176 & 6\,765\,271 & 22\,624\,951 \\
		380 \, S(n-5) + 148 & 644\,628 & 2\,008\,828 & 6\,765\,288 & 23\,160\,388 \\
	\end{NiceArray}
\end{array}
\]
\end{center}
\end{table}

Except for \(S(8)\), \(S(9)\), and \(S(13)\), the best lower bounds are obtained thanks to
the fifth inequality \( S(n+5) \geqslant 380 \, S(n) + 148\). The table
does not go any further, but the same inequality allows one to improve the
lower bounds for \( n \geqslant 15 \).

\begin{corollary}
\begin{sloppypar}
The growth rate for Schur numbers (and Ramsey numbers \(R_n(3)\))  satisfies \({\gamma \geqslant \sqrt[5]{380} \approx 3.28}\).
\end{sloppypar}
\end{corollary}

\begin{proof}
It is a mere consequence of the inequality \( S(n+5) \geqslant 380 \, S(n) + 148\). As for Ramsey
numbers, the following inequality holds \(S(n) \leqslant R_n(3) - 2\) (see \cite{AbbottHanson}) hence the result. \\
\end{proof}


\subsection{Conclusion on S-templates}

First, we formalized Rowley's template-based constructions \cite{RowleyRamsey} in the context of Schur numbers 
by introducing S-templates as well as a new sequence, \(S^+\). We found new S-templates allowing us to obtain 
new lower bounds for schur numbers. One may notice that we mostly gave only lower bounds for \(S^+\). It should be possible to 
find better S-templates by making different assumptions or using a different method (Monte-Carlo methods, for instance).

\par
In the next section, we provide similar results for weak Schur numbers. We introduce WS-templates and a corresponding sequence, 
\(\WS^+\). Then, we derive similar relations and a construction method allowing us to find new lower bounds for weak Schur numbers.


\section{Templates for weak Schur numbers}
\label{WeakSchur}

We generalize Rowley's constructions for weak Schur numbers \cite{RowleyWS}. We give an analogous for weak Schur numbers of Abbott 
and Hanson's construction for Schur numbers \cite{AbbottHanson}. Then, as in the previous section, we introduce \textit{WS-templates}, 
standing for \textit{"weak Schur templates"}, as well as an associated sequence \(\WS^+(n)\). We find templates and use them to provide 
new lower bounds for weak Schur numbers. Finally, we give a short explanation for the new lower bound \(\WS(6) \geqslant 646\) which 
was not directly obtained with a template, contrary to the other lower bounds given in this article.

\subsection{Inequality for weak Schur numbers using Schur and weak Schur numbers}

Up to now, no equivalent for weak Schur numbers of Abbott and Hanson's construction for Schur numbers
\cite{AbbottHanson} was known. Here we give a general lower bound for weak Schur numbers as a function of both
regular and weak Schur numbers.

\begin{theorem}
\label{thm:WS-ab}
\begin{sloppypar}
Let \((p,k), (q,n) \in (\mathbb{N}^*)^2\). If there are a weakly sum-free \(n\)-partition of \([\![1,q]\!]\)
and a sum-free \(k\)-partition of \([\![1,p]\!]\) then there is a partition of
\({[\![1,p(q+\left \lceil \frac{q}{2} \right \rceil + 1)+q]\!]}\) into \(n+k\) weakly sum-free subsets.
\end{sloppypar}
\end{theorem}

As Theorem \ref{thm:WS-ab} is actually a particular case of a more general theorem (Theorem \ref{thm:WStemp}) which will
be formulated after the introduction of templates for weak Schur number,
we only outline the demonstration. Its complete \hyperref[PreuveThm]{proof} using templates 
for weak Schur numbers is in Subsection \ref{ConstructionWS}.

Let \((p, k), (q, n) \in (\mathbb{N}^*)^2\) such that there are a weakly sum-free \(n\)-partition of \([\![1,q]\!]\) 
and a sum-free \(k\)-partition of \([\![1,p]\!]\). Let \(a \in \mathbb{N}\) with \(a > q\)
and let us try to build a coloring of \([\![1, ap + q]\!]\) into \(n + k\) weakly sum-free subsets. Let
\(l = a - q - 1\), \(r \in [\![1,q]\!]\) and \(w = a - l - r - 1 = q - r\).

First, we construct the following table with \(a\) columns and \(p+1\) rows containing the integers from \([\![1, ap + q]\!]\). 
The columns are numbered from \(-l\) to \(+q\). This table is made of three different blocks.

\begin{itemize}
	\item \(\mathcal{T}\) (the "tail"): in the row indexed by 0: numbers from \([\![1,q]\!]\).
	\item \(\mathcal{R}\) (the "rows"): the integers in columns from \(-l\) to \(+r\).
	\item \(\mathcal{C}\) (the "columns"): the integers in the last \(w\) columns.
\end{itemize}

\setlength{\arraycolsep}{2pt}

\begin{figure}[H]
{\footnotesize
	\caption{Construction of the weakly sum-free coloring}\label{SchemaWS}}
\begin{center}
\renewcommand{\arraystretch}{1.5}
\begin{small}
\[
\begin{NiceArray}{*{13}{c}}[corners={NW,SW},hvlines,first-row,last-row,first-col]
\CodeBefore
	\cellcolor{green}{1-6}
	\cellcolor{green}{1-7}
	\cellcolor{cyan}{1-8}
	\cellcolor{green}{1-9}
	\cellcolor{cyan}{1-10}
	\cellcolor{cyan}{1-11}
	\cellcolor{cyan}{1-12}
	\cellcolor{green}{1-13}
	\cellcolor{red}{2-1}
	\cellcolor{red}{2-2}
	\cellcolor{red}{2-3}
	\cellcolor{red}{2-4}
	\cellcolor{red}{2-5}
	\cellcolor{red}{2-6}
	\cellcolor{red}{2-7}
	\cellcolor{red}{2-8}
	\cellcolor{red}{2-9}
	\cellcolor{cyan}{2-10}
	\cellcolor{cyan}{2-11}
	\cellcolor{cyan}{2-12}
	\cellcolor{green}{2-13}
	\cellcolor{yellow}{3-1}
	\cellcolor{yellow}{3-2}
	\cellcolor{yellow}{3-3}
	\cellcolor{yellow}{3-4}
	\cellcolor{yellow}{3-5}
	\cellcolor{yellow}{3-6}
	\cellcolor{yellow}{3-7}
	\cellcolor{yellow}{3-8}
	\cellcolor{yellow}{3-9}
	\cellcolor{cyan}{3-10}
	\cellcolor{cyan}{3-11}
	\cellcolor{cyan}{3-12}
	\cellcolor{green}{3-13}
	\cellcolor{yellow}{4-1}
	\cellcolor{yellow}{4-2}
	\cellcolor{yellow}{4-3}
	\cellcolor{yellow}{4-4}
	\cellcolor{yellow}{4-5}
	\cellcolor{yellow}{4-6}
	\cellcolor{yellow}{4-7}
	\cellcolor{yellow}{4-8}
	\cellcolor{yellow}{4-9}
	\cellcolor{cyan}{4-10}
	\cellcolor{cyan}{4-11}
	\cellcolor{cyan}{4-12}
	\cellcolor{green}{4-13}
	\cellcolor{red}{5-1}
	\cellcolor{red}{5-2}
	\cellcolor{red}{5-3}
	\cellcolor{red}{5-4}
	\cellcolor{red}{5-5}
	\cellcolor{red}{5-6}
	\cellcolor{red}{5-7}
	\cellcolor{red}{5-8}
	\cellcolor{red}{5-9}
	\cellcolor{cyan}{5-10}
	\cellcolor{cyan}{5-11}
	\cellcolor{cyan}{5-12}
	\cellcolor{green}{5-13}
	\cellcolor{cyan}{6-10}
	\cellcolor{cyan}{6-11}
	\cellcolor{cyan}{6-12}
	\cellcolor{green}{6-13}
\Body
	& & & & & & \Block{1-8}{\overbrace{\hphantom{---------------------------}}^{\mathcal{T}}} \\
	& & & & & & 1 & 2 & ... & r & r + 1 & ... & q - 1 & q \\
	\Block{5-1}{\mathcal{R} \left\{ \vphantom{\begin{array}{l} . \\ . \\ . \\ . \\ . \\ . \\ . \\  . \end{array}} \right.}
	& a - l & a - l + 1 & ... & a - 1 & a & a + 1 & ... & a + r - 1 & a + r & a + r + 1 & ... & a + q - 1 & a + q \\
	& 2 a - l & ... & ... & ... & 2 a & ... & ... & ... & 2 a + r & ... & ... & ... & 2 a + q \\
	& ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... \\
	& ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... \\
	& p a - l & ... & ... & ... & p a & ... & ... & ... & p a + r & ... & ... & ... & p a + q \\
	& & & & & & & & & & \Block{1-4}{\underbrace{\hphantom{--------------}}_{\mathcal{C}}} \\
\end{NiceArray}
\]
\end{small}
\end{center}
\end{figure}

\setlength{\arraycolsep}{6pt}

\noindent \underline{\textbf{\(\mathcal{T}\) block}}
\par
We color this block using the weakly sum-free coloring of \([\![1,q]\!]\) with colors \(1, ..., n\).

\noindent \underline{\textbf{\(\mathcal{R}\) block}}
\par
We use the colors \(n + 1, ..., n + k\) in this block. We color an integer \(x\) according to its line number \(\lambda(x)\).
For any \(x \in \mathcal{R}\), we color \(x\) with \(n + c\) where \(c\) is the color of \(\lambda(x)\) in the sum-free coloring of  \([\![1,p]\!]\).
Let \((x, y) \in \mathcal{R}^2\). The cases are twofold.

\begin{itemize}
	\item \underline{\(\lambda(x+y) = \lambda(x) + \lambda(y)\)} \\
	If \(x + y\in \mathcal{R}\), we use the sum-free property of the coloring of \([\![1,p]\!]\). Otherwise, \(x + y\in \mathcal{C}\) which 
	is fine because we only use colors \(1, ..., n\) in block \(\mathcal{C}\).
	\item \underline{\(\lambda(x+y) \neq \lambda(x) + \lambda(y)\)} \\
	In this case, we do not have information about the color of \(\lambda(x+y)\). Thereby, we want to have
	\(x+y \in \mathcal{C}\). A simple solution is to limit the horizontal displacement made by summing the two integers.
	That is, when the sum's row number is different from \(\lambda(x) + \lambda(y)\), to upper bound 
	\(|x + y - (\lambda(x) + \lambda(y)) a|\) so that \(x+y\) stays in \(\mathcal{C}\). There, the maximal displacement 
	to the left (resp. to the right) is \(2l\) (resp. \(2r\)). Not crossing entirely \(\mathcal{C}\) by going to the left is then 
	expressed as \(-2l > -a + r\). Likewise, not going to far to the right is expressed as \(2r < a - l\). It can then be written
	as \(\max(l, r) \leqslant w\).
\end{itemize}

\noindent \underline{\textbf{\(\mathcal{C}\) block}}
\par
In this block, we use colors \(1, ..., n\). We color an integer \(x\) according to its projection on the first row \(\pi(x)\) offeset by \(a\), 
that is its column number. A simple solution is to color \(x\) with the same color as \(\pi(x) - a\) in the weakly sum-free coloring of 
\([\![1,q]\!]\). As long as \(2q \leqslant a + r\) (not going two far to the right) and there is no \(x \in \pi(\mathcal{C}) - a\) such that 
\(2x \in \pi(\mathcal{C}) - a\), we do not have a sum in \(\mathcal{C}\) when taking two numbers in the same colum. Finally, the 
weakly sum-free property of the coloring of \([\![1,q]\!]\) guarantees that if \(x \in [\![1,r]\!]\) and \(y \in \mathcal{C}\) are colored 
the same, then \(x + y\) is colored differently.

Setting \(w = l = \left\lceil \displaystyle \frac{q}{2} \right\rceil\) and \(r = \left\lfloor \displaystyle \frac{q}{2} \right\rfloor\) satisfies these 
constraints: it corresponds to Theorem \ref{thm:WS-ab}. \\

By setting \(q = \WS (n)\) and \(p = S(k)\) in Theorem \ref{thm:WS-ab}, one obtains the following corollary.

\begin{corollary}
\label{cor:ineqWS-S}
\(\WS (n+k) \geqslant S(k) \left (\WS (n) + \left \lceil \displaystyle \frac{\WS (n)}{2} \right \rceil +1 \right) + \WS (n)\)
for all \((n,k) \in (\mathbb{N}^*)^2\).
\end{corollary}

This can be seen as an equivalent for weak Schur numbers of Abott and Hanson's construction for Schur numbers 
\cite{AbbottHanson}. This formula also includes the results from \cite{RowleyWS} as a special case. For \(n>2\), 
the formula from Corollary \ref{cor:ineqWS-S} does not give new lower bounds.

\begin{remark}
The inequality from Corollary \ref{cor:ineqWS-S} can be improved by adding 1 to the lower bound if \(\WS (n)\) is odd (more generally if \(q\) is
odd in Theorem \ref{thm:WS-ab}). However, it lengthens the proof and it is never useful in practice.
\end{remark}
\par
Now, we introduce WS-templates and the sequence \(\WS^+\) in order to generalize the above construction.

\subsection{Definition of \([\![ 1, \WS^+ ]\!]\)}
\label{DefinitionWS+}

In this subsection, we introduce WS-templates and prove calculative results for the general construction
theorem on templates for weak Schur numbers.

\begin{definition}
Let \((a,b) \in (\mathbb{N}^*)^2\) such that \(a>b\). We define:
\[ \pi_{a,b}:x \longmapsto (\operatorname{Id}+a\mathds{1}_{ [\![0,b]\!]})(x \mod a).\]
\end{definition}

\begin{sloppypar}
If there is no confusion on the \(a\) and \(b\) to use, \(\pi_{a, b}\) is denoted by \(\pi\). Notice that for all \(x \in \mathbb{Z}\), 
\({\pi(x) = x \mod a}\) and for all \(x \in [\![b + 1, a + b]\!], b + 1 \leqslant \pi(x) \leqslant a + b\).
\end{sloppypar}

\begin{sloppypar}
Function \(\pi\) is the projection on the first line mentioned in the intuitive explanation. The following four propositions are
calculative properties on \(\pi\) reflecting the behaviour of an element's column number in \hyperref[SchemaWS]{Figure 3} and
that we will use later when we introduce WS-templates.
\end{sloppypar}

\begin{proposition}
\label{prop1}
\[
\forall x \in [\![b + 1, a + b]\!], \pi(x) = x.
\]
\end{proposition}

\begin{proof}
\begin{sloppypar}
Let \(x \in [\![b + 1, a + b]\!]\). If \(x < a\) then \(x \mod a = x \notin [\![1, b]\!]\). Hence \(\pi(x) = x\).
Otherwise, \({x \mod a = x - a \in [\![1, b]\!]}\). Hence \({\pi(x) = x - a + a = x}\).
\end{sloppypar}
\end{proof}

\begin{proposition}
\label{prop2}
Let x \(\in [\![1,b]\!]\) and \(y \in \mathbb{N}^*\). Then
\[
\pi(x+\pi(y)) = \pi(x+y).
\]
\end{proposition}

\begin{proof}
It is a direct consequence of \(\pi(x) = x \mod a\). \\
\end{proof}

\begin{proposition}
\label{prop3}
Let x \(\in [\![1,b]\!]\) and \(y \in \mathbb{N}^*\) such that \(x+\pi(y) \leqslant a+b\). Then
\[
\pi(x+y)=x+\pi(y).
\]
\end{proposition}

\begin{proof}
\(\pi(y) \geqslant b + 1\) and thus \(b + 1 \leqslant x + \pi(y) \leqslant a + b\).
\[
\begin{array}{l l l l}
	\pi(x + y) & = & \pi(x + \pi(y)) & \text{by Proposition \ref{prop2}} \\
	 & = & x + \pi(y) & \text{by Proposition \ref{prop1}}
\end{array}
\]
\end{proof}

\begin{proposition}
\label{prop4}
Let \((x,y)\in (\mathbb{N}^*)^2\). Then
\[
\pi(\pi(x)+\pi(y))=\pi(x+y).
\]
\end{proposition}

\begin{proof}
It is a direct consequence of \(\pi(x) = x \mod a\). \\
\end{proof}

After defining the function related to the column number of each element in \hyperref[SchemaWS]{Figure 3},
we introduce the function related to its line number.

\begin{definition}
Let \((a,b) \in (\mathbb{N}^*)^2\) such that \(a>b\). Define
\[ \lambda_{a,b}:x \longmapsto 1+ \left\lfloor\dfrac{x-b-1}{a}\right\rfloor.\]
\end{definition}

If there is no confusion on the \(a\) and \(b\) to use, \(\lambda_{a, b}\) is denoted by \(\lambda\).

Function \(\lambda\) maps an element \(x\) to its line number as mentioned in the intuitive explanation.
As we have just done with \(\pi\), we prove three more calculative results on both \(\pi\) and \(\lambda\) that are used in
Subsection \ref{ConstructionWS}.

\begin{proposition}
\label{prop5}
Let \(x\in \mathbb{N}^*\). Then
\[
x=a\lambda(x)+\pi(x)-a.
\]
\end{proposition}

\begin{proof}
Let \((a,b)\in (\mathbb{N}^*)^2\) such that \(a>b\) and let \(x\in \mathbb{N}^*\). \\
We have \(a\lambda(x)+\pi(x)-a=a\left\lfloor\dfrac{x-b-1}{a}\right\rfloor+(x \mod a)+ a \mathds{1}_{ [\![0,b]\!]}(x \mod a)\).

\begin{itemize}
\item If \(x \mod a>b\) then \(a\lambda(x)+\pi(x)-a=a\left\lfloor\dfrac{x}{a}\right\rfloor+x \mod a=x\).
\item If \(x \mod a \leqslant b\) then \(a\lambda(x)+\pi(x)-a=a \left( \left \lfloor \dfrac{x}{a} \right \rfloor - 1 \right)+x \mod a +a=x\).
\end{itemize}
\end{proof}

\begin{proposition}
\label{prop6}
Let \(x, y \in \mathbb{Z}\) such that \(\lambda(x + y) = \lambda(y)\). Then
\[
\pi(x + y) = x + \pi(y).
\]
\end{proposition}

\begin{proof}
By applying Proposition \ref{prop5} twice, we get \(a \lambda(x + y) + \pi(x + y) - a = x + y = x + a \lambda(y) + \pi(y) - a\).
The result is then obtained by simplifying the equality. \\
\end{proof}

\begin{proposition}
\label{prop7}
Let \(x, y \in \mathbb{Z}\) such that \(\pi(x) + \pi(y) \in [\![a + b + 1, 2 a + b]\!]\). Then
\[
\lambda(x + y) = \lambda(x) + \lambda(y).
\]
\end{proposition}

\begin{proof}
By Proposition \ref{prop5}, \(x + y = a (\lambda(x) + \lambda(y)) + \pi(x) + \pi(y) - 2 a\). Then
\[
\begin{array}{l l l}
	\lambda(x + y) & = & \left \lfloor \dfrac{x + y - b - 1}{a} \right \rfloor + 1 \vspace{1mm} \\
	 & = & \left \lfloor \dfrac{a (\lambda(x) + \lambda(y)) + \pi(x) + \pi(y) - 2 a - b - 1}{a} \right \rfloor + 1 \vspace{1mm} \\
	 & = & \lambda(x) + \lambda(y) - 1 + \left \lfloor \dfrac{\pi(x) + \pi(y) - b - 1}{a}\right\rfloor \\
	 & = & \lambda(x)+\lambda(y) -1 +1 ~~~~\text{since } \pi(x) + \pi(y) \in [\![a + b + 1, 2 a + b]\!] \\
	 & =& \lambda(x)+\lambda(y).
\end{array}
\]
\end{proof}

\begin{definition}
Let \( (a,n,b) \in (\mathbb{N}^*)^3\) with \(a > b\). Let \((A_1,...,A_n)\) a partition of  \([\![1, a + b]\!]\).
This partition is said to be a \(b\)-weakly-sum-free template (\(b\)-WS-template) with width \(a\) and \(n\) colors when:

\begin{itemize}
\item \(\forall i \in [\![1, n]\!], A_i\) is weakly-sum-free,
\item \(\forall i \in [\![1, n]\!], A_i\backslash [\![1, b]\!]\) is sum-free,
\item For \(A_n\) (the special subset):
	\[
	\forall (x,y) \in A_n^2, \,x+y>b+2a \implies x+y-2a\notin A_n,
	\]
\item For the others subsets
	\[
	\forall i \in [\![1,n-1]\!], \, \forall(x,y) \in A_i^2, \, x+y>a+b \implies \pi(x+y) \notin A_i.
	\]
\end{itemize}
\end{definition}

Number \(a\) is necessarily colored with color \(n\). Note that the special color \(n\) is not necessarily the last color by order of appearance.
Now, we introduce the number \(\WS^+(n)\) that plays the same role as \(S^+(n)\) for S-templates. 

\begin{definition}
Let \( (n,b) \in (\mathbb{N}^*)^2\). If there is \(a\) such that there is a \(b\)-WS-template with width \(a\)
and \(n\) colors, we define:
\[
\WS_b^+(n)= \max \{a \in \mathbb{N}^*/ \text{there is a } b \text{-WS-template with width } a \text{ and } n \text{ colors} \}.
\]
If there is no such \(a\), we set \(\WS_b^+(n) = 0\).
\end{definition}

\begin{definition}
Let \( n \in \mathbb{N}^*\). We define:
\[
\WS^+(n)=\max_{b\in \mathbb{N}^*} \WS_b^+(n).
\]
\end{definition}
The following proposition shows how \(\WS^+(n)\) compares to weak Schur numbers.
\begin{proposition}
Let \(n \in [\![2, +\infty]\!]\). Then:
\[
\frac{3}{2} \WS (n-1)+1 \leqslant \WS^+(n) \leqslant \WS (n).
\]
\end{proposition}

\begin{proof}
The lower bound comes from Corollary \ref{cor:ineqWS-S}.
The upper bound comes from the fact that a WS-template with width \(a\) and \(n\) colors is in particular a partition of
\([\![1, a]\!]\) into \(n\) weakly sum-free subsets. \\
\end{proof}

Having established these properties, we prove our main result.

\subsection{Construction of weak Schur partitions using WS-templates}
\label{ConstructionWS}

Theorem \ref{thm:Stemp} describes a manner to extend an S-template into a larger Schur partitions using other Schur 
partitions. Likewise, a WS-template can be extended into larger weak Schur partitions by using Schur partitions. This 
is the object of the following theorem.

\begin{theorem}
\label{thm:WStemp}
Let \((a,n,b) \in (\mathbb{N}^*)^3\) with \(a > b\) and \( (p,k) \in (\mathbb{N}^*)^2\). If there are a sum-free \(k\)-partition of
\([\![1,p]\!]\) and a \(b\)-WS-template \((A_1,...,A_{n+1})\) with width \(a\) and \(n+1\) colors,
then there is a partition of \([\![1, p a + b]\!]\) into \(k+n\) weakly sum-free subsets.
\end{theorem}

\begin{proof}
\begin{sloppypar}
Let \((a,n,b) \in (\mathbb{N}^*)^3\) and \((p,k) \in (\mathbb{N}^*)^2\). Let \(f\) and \(g\) be colorings associated 
to the \(b\)-WS-template and to the sum-free partition of \([\![1,p]\!]\), respectively: 
\({f : [\![1, a + b]\!] \longrightarrow [\![1,n+1]\!]}\) and \({g : [\![1, p]\!]  \longrightarrow [\![1, k]\!]}\). Moreover, 
we assume that the sum-free coloring of \([\![1, p]\!]\) is ordered.
\end{sloppypar}

\par
NB: To keep the notation short, the conditions \(x + y \leqslant p\)  and \(x + y \leqslant a + b\) are omitted in the following five predicates.

The sum-free conditions are expressed as:
\[
\forall (x,y) \in [\![b+1,a + b]\!]^2, f(x) = f(y) \Longrightarrow f(x+y) \neq f(x),
\]
\[
\forall (x,y) \in [\![1,p]\!]^2, g(x) = g(y) \Longrightarrow g(x+y) \neq g(x).
\]

The weakly sum-free condition is expressed as:
\[
\forall (x,y) \in [\![1,a + b]\!]^2, \left\{
\begin{array}{l}
	f(x) = f(y) \\
	x \neq y
\end{array}
\right. \Longrightarrow f(x+y) \neq f(x),
\]

The  additional constraints for the WS-template are expressed as:
\[
\forall (x,y) \in [\![1,a + b]\!]^2, \left\{
\begin{array}{l}
	f(x) = f(y) \leqslant n \\
	x + y > a + b
\end{array}
\right. \Longrightarrow f(\pi(x+y)) \neq f(x),
\]
\[
\forall (x,y) \in [\![1,a + b]\!]^2, \left\{
\begin{array}{l}
	f(x) = f(y) = n + 1 \\
	x + y > 2 a + b
\end{array}
\right. \Longrightarrow f(x+y - 2 a) \neq f(x).
\]

We split \([\![1, p a + b]\!]\) into three subsets. \\
NB: To keep the notation short, the restriction to \([\![b + 1, p a + b]\!]\) of \(\pi\) defined in Subsection \ref{DefinitionWS+}
is denoted by \(\pi\) in the hereunder equations:

\begin{itemize}
	\item \(\mathcal{T} = [\![1, b]\!]\),
	\item \(\mathcal{C} = \pi^{-1}(f^{-1}([\![1, n]\!]))\),
	\item \(\mathcal{R} = \pi^{-1}(f^{-1}(\{n + 1\}))\).
\end{itemize}

We define a coloring \(h\) of \([\![1, p a + b]\!]\) using \( [\![1,n+k]\!]\) colors:
\[
\begin{array}{c c c l}
	h : & [\![1, p a + b]\!] & \longrightarrow & [\![1,n+k]\!],\\
	& x & \longmapsto &
	\left\{ \begin{array}{l l}
		f(x), & \text{if}~x \in \mathcal{T}, \\
		f(\pi(x)), & \text{if}~x \in \mathcal{C}, \\
		n + g(\lambda(x)), & \text{if}~x \in \mathcal{R}.
	\end{array} \right.
\end{array}
\]

Function \(h\) is well defined since sets \(\mathcal{T}, \mathcal{C}, \mathcal{R}\) partition \([\![1, p a + b]\!]\).
Now, we prove that \(h\) is a weakly sum-free coloring. Let \(x,y \in [\![1, p a + b]\!]\) be such that \(x \neq y\),
\(h(x) = h(y)\), and \(x+y \leqslant p a+ b\). We claim that \(h(x+y) \neq h(x)\). Nine cases are to be distinguished
according to which of the sets \(\mathcal{T}, \mathcal{C}, \mathcal{R}\) \(x\) and \(y\) belong to. It is
sufficient to check only six cases out of nine since \(x\) and \(y\) play symmetric roles. \\

\noindent \underline{\textbf{Case 1:} \((x,y) \in \mathcal{T}^2\)}
\par
If \(x + y \leqslant b\) then \(h(x+y)=f(x+y)\). Otherwise, \(b < x+y < a+b\) since \(b < a\) and
therefore \(\pi(x + y) = x +y\) (Proposition \ref{prop1}). Hence in both cases \(h(x+y)=f(x+y)\). Given that
\(f\) is a weakly sum-free coloring, \(f(x + y) \neq f(x)\) since \(f(x)=h(x)=h(y)=f(y)\) and \(x \neq y \). That
is \(h(x + y) \neq h(x)\). \\

\noindent \underline{\textbf{Case 2:} \((x,y) \in \mathcal{T} \times \mathcal{C}\)}
\par
Given that \(h(x) = h(y)\) and by definition of \(h\), \(f(x) = f(\pi(y))\). Besides, \(f(\pi(y)) \leqslant n\) since
\(y \in \mathcal{C}\). Two cases are to be distinguished according to the value of \(x + \pi(y)\).
\begin{itemize}
\item \begin{sloppypar}
	If \(x + \pi(y) \leqslant a + b\) then \(f(x + \pi(y)) = f(\pi(x + y))\) (Proposition \ref{prop3}). Given that \(f\) is
	a weakly sum-free coloring, \(f(x+\pi(y)) \neq f(x)\) since \(f(x)=f(\pi(y))\) and \(x \neq \pi(y)\) since
	\({x \leqslant b < \pi(y)}\).
	\end{sloppypar}
\item \begin{sloppypar}
	If \(x+\pi(y)> a+b\) then given that \(f\) is a WS-template and since \({f(x) = f(\pi(y)) \leqslant n}\),
	\({f(\pi(x+\pi(y))) \neq f(x)}\).~Furthermore \({f(\pi(x+\pi(y))) = f(\pi(x+y))}\) (Proposition \ref{prop2}), such that
	\({f(\pi(x+ y)) \neq f(x)}\).
	\end{sloppypar}
\end{itemize}
\par
In both cases \(f(\pi(x+y)) \neq f(x)\). If  \(f(\pi(x+y)) \leqslant n\) then \(h(x+y) = f(\pi(x+y))\). Therefore
\(h(x+y) \neq h(x)\) since \(f(x) = h(x)\). Otherwise, \(f(\pi(x+y)) = n + 1\) and thus \(h(x+y) > n\). In particular,
\(h(x + y) \neq h(x)\) since \(h(x) = h(y) \leqslant n\). \\

\noindent \underline{\textbf{Case 3:} \((x,y) \in \mathcal{T} \times \mathcal{R}\)}
\par
Necessarily \(h(x) = h(y) = n + 1\). Two cases are to be distinguished according to the value of \(\lambda(x+y)\).
\begin{itemize}
\item If \(\lambda(y)=\lambda(x+y)\) then \(\pi(x + y) = x + \pi(y)\) (Proposition \ref{prop6}). By definition of
	\(h\), \(f(x) = f(\pi(y))\). Given that \(f\) is a weakly sum-free coloring, \(f(x + \pi(y)) \neq f(x)\) since
	\(f(x) = f(\pi(y))\) and \(x \neq \pi(y)\) since \({x \leqslant b < \pi(y)}\). Hence \(h(x + y) \neq h(x)\).
\item If \(\lambda(y) \neq \lambda(x + y)\) then \(\lambda(x + y) = \lambda(y) + 1\) since \(x \leqslant b < a\).
	Besides, \(n + 1 = h(y) = n +  g(\lambda(y))\). Hence \(g(\lambda(y)) = 1\). Moreover \(g(1) = 1\) since \(g\)
	is an ordered coloring. Therefore, given that \(g\) is sum-free, \(g(\lambda(y) + 1) \neq 1\). If \(\pi(x + y) \in
	A_{n + 1}\) then \(h(x + y) = n + g(\lambda(x + y)) \neq n + 1\). Otherwise, \(h(x + y) \leqslant n\).
\end{itemize}
\par
In both cases \(h(x + y) \neq h(x)\).

\noindent \underline{\textbf{Case 4:} \((x,y) \in \mathcal{C}^2\)}
\par
By definition of \(h\) and since \(h(x)=h(y)\), \(f(\pi(x)) = f(\pi(y))\). Two cases are to be distinguished according
to the value of \(\pi(x)+\pi(y)\).
\begin{itemize}
\item If \(\pi(x) + \pi(y) \leqslant a+b\) then \(\pi(x)+\pi(y) = \pi(x + y)\). Hence \(f(\pi(x + y)) \neq f(\pi(x))\) since
	\(f\) is sum-free for \(x>b\)
\item \begin{sloppypar}
	If \(\pi(x)+\pi(y)>a+b\) then given that \(f\) is a WS-template, \({f(\pi(\pi(x)+\pi(y))) \neq f(\pi(x))}\) since
	\({f(\pi(x)) = f(\pi(y))}\). Besides,  \({f(\pi(\pi(x)+\pi(y))) = f(\pi(x + y))}\) (Proposition \ref{prop4}). Hence \({f(\pi(x + y))
	\neq  f(\pi(x))}\).
	\end{sloppypar}
\end{itemize}
\par
In both cases \(f(\pi(x+y)) \neq f(x)\). If  \(f(\pi(x+y)) \leqslant n\) then \(h(x+y) = f(\pi(x+y))\). Therefore
\(h(x+y) \neq h(x)\) since \(f(x) = h(x)\). Otherwise, \(f(\pi(x+y)) = n + 1\) and thus \(h(x+y) > n\). In particular,
\(h(x + y) \neq h(x)\) since \(h(x) = h(y) \leqslant n\). \\

\noindent \underline{\textbf{Case 5:} \((x,y) \in \mathcal{C} \times \mathcal{R}\)}
\par
By definition of function \(h\), \(h(x) \neq h(y)\).\\

\noindent \underline{\textbf{Case 6:} \((x,y) \in \mathcal{R}^2\)}
\par
In particular \(f(\pi(x)) = f(\pi(y))=n + 1\). Three cases are to be distinguished according to the value of \(\pi(x) + \pi(y)\).
\begin{itemize}
\item If \(\pi(x) + \pi(y) \in [\![a + b + 1, 2 a + b]\!]\) then \(\lambda(x + y) = \lambda(x) + \lambda(y)\)
	(Proposition \ref{prop7}). By definition of \(h\) and since \(h(x) = h(y)\), \(g(\lambda(x)) = g(\lambda(y))\).
	Hence, \(h(\lambda(x + y)) \neq h(\lambda(x))\) since \(h\) is a sum-free coloring. If \(f(x+y) \geqslant n + 1\)
	then \(h(x + y) = n + g(\lambda(x + y))\). And \(h(x) = n + g(\lambda(x))\). Therefore, \(h(x + y)  \neq h(x)\).
	Otherwise \(h(x+y) \leqslant n < h(x)\). In particular \(h(x + y) \neq h(x)\).
\item If \(\pi(x)+\pi(y)>2a+b\) then \(f(\pi(\pi(x)+\pi(y))) \neq f(\pi(x)) = n + 1\) since \(f\) is a \(b\)-WS template and
	\(f(\pi(x)) = f(\pi(y))\). Given that \(\pi(\pi(x)+\pi(y)) = \pi(x+y)\) (Proposition \ref{prop4}), \(f(\pi(x+y)) \neq n + 1\).
\item \begin{sloppypar}
	If \(\pi(x)+\pi(y)\leqslant b+a\) then, given that \(\pi(x)+\pi(y) \geqslant b\) and \(f_{| [\![b, a + b ]\!]}\) is
	sum-free, \({f(\pi(x) + \pi(y)) \neq f(\pi(x)) = n + 1}\). That is \({f(\pi(x + y)) \neq n + 1}\) (Proposition \ref{prop1}).
	\end{sloppypar}
\end{itemize}
\par
In both of the last two cases, \({f(\pi(x + y)) \neq n + 1}\) that is \(x+y \in \mathcal{C}\). Therefore \(h(x+y) < n \leqslant h(x)\).
In particular, \(h(x + y) \neq h(x)\). \\
\end{proof}

We go back to Theorem \ref{thm:WS-ab} which can be seen as a particular case of Theorem \ref{thm:WStemp} in the same way Abott and Hanson's 
construction \cite{AbbottHanson} can be seen as a particular case of Theorem \ref{thm:Stemp}. Its deferred proof is given below.

\begin{proof}[\textsc{Proof of Theorem \ref{thm:WS-ab}.}]
\label{PreuveThm}
Let \((q, n) \in (\mathbb{N}^*)^2\) such that there is a partition of \([\![1, q]\!]\) into n weakly sum-free subsets. 
Let \(f: [\![1, q]\!] \rightarrow [\!]1, n]\!]\) be a weakly sum-free colouring.
Let \(b=q\) and \(a = q + \left \lceil \dfrac{q}{2} \right \rceil + 1\). A new colouring \(g\) is defined as follows:

\[
\begin{array}{c c c l}
	g : & [\![1, a + b]\!] & \longrightarrow & [\![1, n + 1]\!], \\
	& x & \longmapsto &
		\left\{ \begin{array}{l l}
			f(x), & \text{if}~x \in [\![1, b]\!],  \\
			n + 1, & \text{if}~x \in [\![b + 1, 2 b + 1]\!], \\
			f(x - a), & \text{if}~x \in  [\![2 b + 2, a + b]\!].
		\end{array} \right.
\end{array}
\]

We claim that \(g\) is a \(b\)-WSF-template with width \(a\) and \(n + 1\) colours.

\begin{itemize}
\item Function \(g_{|[\![b + 1, a + b]\!]}\) is a sum-free colouring. Indeed, let \((x, y) \in 
	[\![b + 1, a + b]\!]^2\) such that \(g(x) = g(y)\). If \(g(x) = n + 1\) then \(z = x + y > 2 b + 1\) 
	and therefore, either \(z > a + b\) or \(f(z) \neq n + 1\). Otherwise, \(x + y > a + b\).
\item Function \(g\) is a weakly sum-free colouring. Indeed, let \((x, y) \in [\![1, a + b]\!]^2\) such that 
	\(z = x + y \leqslant a + b\) and \(g(x) = g(y)\). Given that \(x\) and \(y\) have symmetric roles, 
	we can assume that \(x \leqslant y\). If \(x > b\) then \(g(z) \neq g(x)\) as seen above. If \(y \leqslant b\) then 
	\(f(x) = g(x) = g(y) = f(y) \leqslant n\) and either \(z \leqslant a + b\) and \(f(z) \neq f(x)\) since \(f\) is a weakly 
	sum-free colouring or \(a + b + 1 \leqslant z \leqslant 2 b\) and \(g(z) = n + 1\); therefore \(g(z) \neq g(x)\). If 
	\(x \leqslant b\) and \(y > b\) then \(g(x) = f(x)\), \(g(y) = f(y - a)\) and \(g(z) = f(z - a)\).We have \(x \neq y - a\) 
	(otherwise, we would have \(a + b \geqslant z = 2 y  - a \geqslant 4 b + 4 - a > a + b\)) and thus \(f(x + y - a) \neq f(x)\),
	that is \(g(z) \neq g(x)\).
\item Colour \(n + 1\) verifies the  additional constraints for the special colour. Indeed, \(b + 2 a \geqslant 4 b + 2\). 
	Hence, \(\forall (x, y) \in g^{-1}(\{n + 1\}), x + y \leqslant b + 2 a\).
\item Colours \(1, ..., n\) verify the  additional constraints for the regular colours. Indeed, let 
	\((x, y) \in g^{-1}([\![1, n]\!])\) such that \(x + y > a + b\). Given that \(x\) and \(y\) have symmetric roles, 
	we can assume that \(x \leqslant y\). Necessarily \(y \geqslant 2 b + 2\). If \(x \leqslant b\) then 
	\(z = x + y \in [\![a + b + 1, a + 2 b]\!]\) and therefore \(\pi(z) \in [\![b + 1, 2 b]\!]\). Otherwise, 
	\(z = x + y \in [\![4 b + 4, 2 a + 2 b]\!]\) and therefore \(\pi(z) \in [\![b + 1, 2 b]\!]\). Hence, in both cases, 
	\(g(\pi(z)) \neq g(x)\).
\end{itemize}

The result is then obtained by applying Theorem \ref{thm:WStemp}. \\
\end{proof}

By setting \(p = S(k)\) and \(a = \WS^+(n + 1)\) in Theorem \ref{thm:WStemp}, one obtains:

\begin{corollary}
\label{cor:ineqWS+}
Let \(n,k \in \mathbb{N}^*\) and set \( b_{max} = \max \{b\in \mathbb{N}^*/ \WS_b^+(n+1) = \WS^+(n+1)\}\).
Then:
\[
\WS(n+k) \geqslant S(k) \WS^+(n+1)+b_{max}.
\]
\end{corollary}

\begin{remark}
In the S-template construction for Schur numbers, the additive constant comes from the fact that the special color does
not necessarily appear at the very begining of the repeating pattern. Likewise, \(b_{max}\) can actually be replaced by
\[
\max_{b \in \mathbb{N}^*} \left\{\min (A_{n+1} \backslash [\![1, b ]\!]) - 1~|~ \WS_b^+(n+1) = \WS^+(n+1) \right\}.
\]
\end{remark}

As in Corollary \ref{cor:ineqS}, the additive constant Theorem \ref{thm:WStemp} can be improved 
by weakening the hypotheses made on the last row. The principle behind it is the same as in Proposition \ref{prop:rafStemp}.

\begin{proposition}
\label{prop:tunelastrow}
Let \((b, k, a) \in (\mathbb{N}^*)^3\) and let \(f\) be a coloring associated to a \(b\)-WS-template with width \(p\) and \(k\) colors. Let
\(c \in \mathbb{N}\) and assume there is a coloring \(g\) of \([\![b + 1, b + c]\!]\) with \(k\) colors such that for all \(c \in [\![1, k]\!]\),

\begin{itemize}
\item \(\forall (x, y) \in  [\![1, a + b]\!] \times  [\![b + 1, a + b]\!],  \left\{
	\begin{array}{l}
		f(x) = f(y) \\
		\pi(x + y) \leqslant b + c
	\end{array}
	\right. \implies g(\pi(x + y)) \neq f(x)\),
\item \(\forall (x, y) \in  [\![1, a + b]\!] \times  [\![b + 1, b + c]\!], \left\{
	\begin{array}{l}
		f(x) = g(y) \\
		\pi(x + y) \leqslant b + c
	\end{array}
	\right. \implies g(\pi(x + y)) \neq f(x)\).
\end{itemize}

Then, for every \(n \in \mathbb{N}^*\), by using on the last row the coloring \(x \longmapsto g(x - p S(n))\), we have\\
\[ \WS(n+k) \geqslant \WS^+(k+1) S(n) + b + c.\]
\end{proposition}

The WS-templates can actually be fine-tuned further. However, it only gives minor improvements (most likely only an 
additive constant) while increasing the size of the search space. 

\par
These modifications rely on one main observation: the first row (excluding the "tail") has constraints that other rows do not 
have because of the tail, especially if the special color appears in the tail as well. Indeed, the line number of the
sum of two numbers in the tail is never greater than one. Therefore, having a coloring dedicated to 
the first row and another coloring dedicated to the repeating pattern would weaken the constraints on the repeating pattern. 

\par
These  additional constraints on the first row imply  additional constraints on the rows of the its color (compared to other 
colors). However, one may notice that there are never two consecutive rows of this color. Moreover these  additional constraints 
mostly concern two consecutive rows. Having a special coloring for rows of this color as well as another color dedicated to the 
first row avoids enforcing these constraints specific to one color on the other colors and thus on the main repeating pattern.

\par
Finally, given that the color of the first row is different from the special color of the main repeating pattern, coloring \(g\) in
Proposition \ref{prop:tunelastrow} can exploit this difference. \\

There is a construction theorem for WS-templates as well.

\begin{theorem}
\label{thm:compWStemp}
Let \((k,p) \in (\mathbb{N}^*)^2\) and \((a, n, b) \in (\mathbb{N}^*)^3\). If there are an S-template with width
\(p\) and \(k+1\) colors and a \(b\)-WS-template with width \(a\) and \(n\) colors, then there is a \(pb\)-WS-template
with width \(pq\) and \((n+k)\) colors.
\end{theorem}

\begin{proof}
The idea is the same as in theorem \ref{thm:WStemp}. The properties specific to WS-templates are inherited 
from both the S-template and the WS-template. \\
\end{proof}

Theorem \ref{thm:compWStemp} yields the following corollary.

\begin{corollary}
Let \(n, k \in \mathbb{N}^*\). Then
\[
\WS^+(n+k) \geqslant S^+(k+1) \WS^+(n).
\]
\end{corollary}

\subsection{New lower bounds for Weak Schur numbers}

We produced WS-templates using the lingeling SAT solver \cite{Lingeling2017}, hence providing lower bounds on \(WS^+\) 
and inequalities of the type \(WS(n+k) \geqslant a S(n) + b\). We sought templates providing the greatest value of \((a, b)\) 
(in the lexicographic order). Details concerning the encoding as a SAT problem can be found in \cite{Heule2017}.

\par
Here are the inequalities given by the current best WS-templates. The \hyperref[WS-templates]{template} 
corresponding to the third inequality can be found in \ref{WS-templates}.

\begin{align}
	WS(n + 1) &\geqslant  4\,S(n)  +  2 \label{WS(n+1)} \\
	WS(n + 2) &\geqslant  13\,S(n)  +  8 \label{WS(n+2)} 
\end{align}

Inequalities (\ref{WS(n+1)}) and (\ref{WS(n+2)}) were found by Rowley, they are detailed in \cite{RowleyWS}.

\begin{align}
	WS(n + 3) &\geqslant  42\,S(n)  +  24 \label{WS(n+3)} \\
	WS(n + 4) &\geqslant  132\,S(n)  +  26 \label{WS(n+4)}
\end{align}

Inequality (\ref{WS(n+3)}), found with a SAT solver \cite{Lingeling2017}, cannot be improved (with this 
definition of WS-template). It uses the first 
sophistication explained in Subsection \ref{ConstructionWS} in order to add
the last number in the first color. As for inequality (\ref{WS(n+4)}), it was obtained by combining an S-template with 
width 33 with a WS-template with width 4. The best template we could find with a computer search gives the 
inequality \(\WS(n+4) \geqslant 127 S(n) + 68\). It was also found with the SAT solver. In order to reduce the search space, 
we only looked for WS-templates with five colors which start with a near-optimal \(\WS(4)\) partition and we assumed that the 
special color was the last by order of appearance. We expect that better WS-templates with \(n \geqslant 5\) 
colors can be found but one would have not to use the above assumptions.

Like in  Subsection \ref{subsec:lowS}, we compute the lower bounds given by Inequalities (\ref{WS(n+1)}),
(\ref{WS(n+2)}), and (\ref{WS(n+3)}) for \( n \in [\![8,15]\!] \). The best lower bound for each value of \(n\) is highlighted.


\begin{table}[H]
{\footnotesize
	\caption{New lower bounds for  \(\WS(n)\) with \( n \in [\![8,15]\!] \)}\label{LowerBoundsWS}}
\begin{center}
\[
\begin{array}{c}
	\begin{NiceArray}{cwc{8ex}wc{10ex}wc{10ex}wc{11ex}}[hvlines]
	\CodeBefore
		\cellcolor{yellow}{2-5}
		\cellcolor{yellow}{3-2}
		\cellcolor{yellow}{4-3}
		\cellcolor{yellow}{4-4}
	\Body
		n & 8 & 9 & 10 & 11 \\
		4 \, S(n-1) + 2 & 6\,786 & 21\,146 & 71\,214 & 243\,794 \\
		13 \, S(n-2) + 8 & 6\,976 & 22\,056 & 68\,726 & 231\,447 \\
		42 \, S(n-3) + 24 & 6\,744 & 22\,536 & 71\,256 & 222\,036 \\
	\end{NiceArray}
	\\ \\
	\begin{NiceArray}{cwc{8ex}wc{10ex}wc{10ex}wc{11ex}}[hvlines]
	\CodeBefore
		\cellcolor{yellow}{2-2}
		\cellcolor{yellow}{3-3}
		\cellcolor{yellow}{4-4}
		\cellcolor{yellow}{4-5}
	\Body
		n & 12 & 13 & 14 & 15 \\
		4 \, S(n-1) + 2 & 815\,314 & 2\,578\,514 & 8\,045\,162 & 27\,061\,154 \\
		13 \, S(n-2) + 8 & 792\,332 & 2\,649\,772 & 8\,380\,172 & 26\,146\,778 \\
		42 \, S(n-3) + 24 & 747\,750 & 2\,559\,840 & 8\,560\,800 &  27\,074\,400 \\
	\end{NiceArray}
\end{array}
\]
\end{center}
\end{table}



\subsection{Another approach: \(\WS(6) \geqslant 646\)}

The weak Schur partitions obtained with WS-templates have an extremely regular structure. Therefore, one may 
expect to find larger partitions by allowing more freedom in the structure of the partitions while still preserving a structure 
somewhat close to a template-based partition thus reducing the search space to a manageable size.

When applying the inequality \(\WS(n+1) \geqslant 4 \, S(n) + 2\), one may realize that it is possible to build a weakly 
sum-free partition of length \(4 \, S(n) + 3\) for small values of \(n\) (\(n \leqslant 4\)) by using the construction of 
Corollary \ref{cor:ineqWS+} for the integers 1, 2, \(4i\) and \(4i+1\) for \(i \in [\![1, S(n)]\!]\) but not 
constraining the other integers. We did the same for the Schur partitions corresponding to Schur number five. More precisely, 
we imposed these constraints only for \(i \leqslant 50\) in order to have more degrees of freedom. The number 50 was chosen 
arbitrarly so that all of the Schur number 5-partitions could be tested in a few hours.

However, trying out all of the 2\,447\,113\,088 Schur number 5-partitions \cite{Heule2017} one by one would not result in a 
reasonable computation time: it is necessary to test the construction on several partitions at once. We encoded the problem as a 
satisfiability problem and used the 1616 backdoors that were used in \cite{Heule2017} in order to encode a group of partitions in 
a compact and efficient way. Among all of the 1616 backdoors, only the 911\textsuperscript{th} backdoor gave a weakly sum-free 
partition of length 643. This backdoor gave a weakly sum-free partition of length 646 and cannot give a weakly sum-free 
partition of length 647. A weakly sum-free partition of length 646 can be found in \ref{WS(6)}.


\subsection{Conclusion on WS-templates}

We started by giving a new construction which can be seen as an equivalent for weakly sum-free partitions of Abott
and Hanson's construction for sum-free partitions. We then generalized this construction by introducing WS-templates. This
allows us to find new lower bounds and new inequalities for weak Schur numbers. One may notice the significant gap
between the former lower bounds for weak Schur numbers obtained by conducting a computer search and the new lower bounds
obtained with WS-templates; thus questioning the methods used and the assumptions made when obtaining these former lower 
bounds. We reckon better WS-templates with \(n \geqslant 5\) colors can be found by making different assumptions 
and using a different method (Monte-Carlo methods for instance).


\section{Conclusion and future work}

We have produced new templates for Schur and Ramsey numbers. We also have generalized the concept of template to weak Schur numbers.
These templates provide new general inequalities of the form \(S(n+k) \geqslant a S(n) + b\) and \(\WS(n+k) \geqslant a S(n) + b\)
as well as new lower bounds for both Schur and weak Schur numbers. We have given a new lower bound \(\WS(6) \geqslant 646\) with
a method that can yield slight improvements for fixed values of \(n\) over lower bounds obtained with the inequality
\(\WS(n+1) \geqslant 4 S(n) + 2\).

Given that the introduction of templates is quite recent, we expect the bounds to be improved as this special type of partition
becomes better understood and larger templates are found. One may try to produce better templates by using heuristics or
approximation algorithms, such as Monte-Carlo algorithms for instance.

The best lower bound \(\WS(6) \geqslant 583\) achieved with a computer search using Monte-Carlo methods
\cite{EliahouBook} is significantly lower than those obtained with a template-like structure: \(\WS(6) \geqslant 642\) \cite{RowleyWS},
\(\WS(6) \geqslant 646\). We have evidence that 583 is the maximal value in the search space considered by
\cite{EliahouBook,Bouzy2015AnAP,Rafilipojaona}. Therefore, it questions the assumption that large partitions for \(\WS(n+1)\)
start with large partitions for \(\WS(n)\). It also indicates that \(\WS(5)\) might need further investigation since the current lower
bound \(\WS(5) \geqslant 196\) \cite{ELIAHOU2012175} was obtained by considering the same type of search space.


\section{Acknowledgements}

This study results from a long-term project performed within the framework of the Project Cluster "Training for Research" of CentraleSuplec.
We would like to address warm thanks to Fred Rowley who kindly answered our many questions
and with who it was a pleasure to exchange. Last but not least, we would like to thank Marijn Heule for providing the backdoors
used in the computation of the new lower bound for \(\WS(6)\).

%\bibliographystyle{IEEEtran}
%\bibliography{biblio}

% edit the bbl file manually to correct the author name for "New lower bounds for weak Schur paritions"
\input{article.bbl}

\appendix

\section{S-templates}
\label{S-templates}

\begin{table}[H]
{\footnotesize
	\caption{S-template with width 33 and 4 colors}}
\begin{center}
\begin{small}
\[
\begin{array}{|*{2}{c|}}
	\hline
	1 & 1, 6, 9, 13, 16, 20, 24, 27, 31 \\
	\hline
	2 & 2, 5, 14, 15, 25, 26 \\
	\hline
	3 & 3, 4, 10, 11, 12, 28, 29, 30 \\
	\hline
	4 & 7, 8, 17, 18, 19, 21, 22, 23, 32, 33 \\
	\hline
\end{array}
\]
\end{small}
\end{center}
\end{table}

\begin{table}[H]
{\footnotesize
	\caption{S-template with width 111 and 5 colors}}
\begin{center}
\begin{small}
\[
\begin{array}{|*{2}{c|}}
	\hline
	1 & 1, 5, 8, 12, 14 ,21, 23, 30, 32, 36, 39, 43, 45, 52, 103, 106, 110 \\
	\hline
	2 & 2, 6, 7, 10, 15, 18, 26, 29, 34, 37, 38, 42, 46, 51, 54, 101, 104, 109 \\
	\hline
	3 & 3, 4, 9, 11, 17, 19, 25, 27, 33, 35, 40, 41, 47, 48, 55, 100, 107, 108 \\
	\hline
	4 & 13, 16, 20, 22, 24, 28, 31, 58, 61, 67, 88, 94, 97 \\
	\hline
	5 & 44, 50, 53, 56, 57, 59, 60, 62, 63, 64, 65, 66, 68, 69, 70,\\
	& 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,\\
	& 86, 87, 89, 90, 91, 92, 93, 95, 96, 98, 99, 102, 105, 111 \\
	\hline
\end{array}
\]
\end{small}
\end{center}
\end{table}

\begin{table}[H]
{\footnotesize
	\caption{S-template with width 380 and 6 colors}}
\begin{center}
\begin{small}
\[
\begin{array}{|*{2}{c|}}
	\hline
	1 & 1, 5, 8, 11, 15, 17, 29, 33, 36, 39, 43, 57, 61, 88, 92, \\
	& 106, 110, 113, 116, 120, 132, 134, 138, 141, 144, 148, 150, 154, 157, 160, \\
	& 164, 178, 182, 185, 188, 341, 344, 347, 351, 365, 369, 372, 375, 379\\
	\hline
	2 & 2, 9, 13, 16, 20, 23, 24, 27, 28, 31, 34, 35, 38, 42, 45,\\
	& 49, 53, 60, 67, 71, 78, 82, 89, 96, 100, 104, 107, 111, 114, 115,\\
	& 118, 121, 122, 125, 126, 129, 133, 136, 140, 147, 158, 162, 165, 169, 172,\\
	& 176, 183, 187, 194, 201, 328, 335, 342, 346, 353, 357, 360, 364, 367, 371\\
	\hline
	3 & 3, 4, 12, 14, 19, 25, 30, 32, 40, 41, 47, 48, 58, 91, 101,\\
	& 102, 108, 109, 117, 119, 124, 130, 135, 137, 145, 146, 152, 153, 161, 163,\\
	& 168, 179, 181, 190, 339, 348, 350, 361, 366, 368, 376, 377\\
	\hline
	4 & 6, 7, 10, 18, 21, 22, 26, 37, 46, 50, 51, 54, 65, 70, 79, 84, 95, 98,\\
	& 99, 103, 112, 123, 127, 128, 131, 139, 142, 143, 151, 155, 156, 159,\\
	& 167, 170, 171, 175, 186, 343, 354, 358, 359, 362, 370, 373, 374, 378\\
	\hline
	5 & 44, 52, 55, 56, 59, 62, 63, 64, 66, 68, 69, 72, 73, 74, 75, 76, 77, 80, 81, 83,\\
	&  85, 86, 87, 90, 93, 94, 97, 105, 189, 196, 197, 200, 203, 206, 207, \\
	& 209, 214, 219, 231, 298, 310, 315, 320, 322, 323,  326, 329, 332, 333, 340\\
	\hline
	6 & 149, 166, 173, 174, 177, 180, 184, 191, 192, 193, 195, 198, 199, 202, 204,\\
	& 205, 208, 210, 211, 212, 213, 215, 216, 217, 218, 220, 221, 222, 223, 224,\\
	& 225, 226, 227, 228, 229, 230, 232, 233, 234, 235, 236, 237, 238, 239, 240,\\
	& 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255,\\
	& 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270,\\
	& 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285,\\
	& 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 299, 300, 301, 302,\\
	& 303, 304, 305, 306, 307, 308, 309, 311, 312, 313, 314, 316, 317, 318, 319, 321,\\
	& 324, 325, 327, 330, 331, 334, 336, 337, 338, 345, 349, 352, 355, 356, 363, 380\\
	\hline
\end{array}
\]
\end{small}
\end{center}
\end{table}

\section{WS-templates}
\label{WS-templates}

\begin{table}[H]
{\footnotesize
	\caption{23-WS-template with width 42 and 4 colors}}
\begin{center}
\begin{small}
\[
\begin{array}{|*{2}{c|}}
	\hline
	1 & 1, 2, 4, 8, 11, 22, 25, 48, 53, \mathbf{(N+1)}\\
	\hline
	2 & 3, 5, 6, 7, 19, 21, 23, 36, 50, 51, 52, 63, 64, 65\\
	\hline
	3 & 9, 10, 12, 13, 14, 15, 16, 17, 18, 20, 54, 55, 56, 57, 58, 59, 60, 61, 62\\
	\hline
	4 & 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 49\\
	\hline
\end{array}
\]
\end{small}
\end{center}
\end{table}

This template provides the inequality \(\WS (n+3) \geqslant 42 \, S(n) + 24\)
by placing one last number, here represented by \(\mathbf{(N+1)}\), in the first subset (see Proposition \ref{prop:tunelastrow}).


\section{\(\WS(6) \geqslant 646\)}
\label{WS(6)}

\begin{table}[H]
{\footnotesize
	\caption{Weakly sum-free partition of \([\![ 1, 646 ]\!] \) into 6 subsets}}
\begin{center}
\begin{small}
	\[
	\begin{array}{|*{2}{c|}}
		\hline
		1 & 1, 2, 6, 10, 14, 18, 26, 30, 34, 42, 46, 50, 54, 62, 70, 79, 82, 90, 95, 99, 111, \\
		& 115, 119, 123, 131, 135, 139, 143, 151, 155, 159, 163, 171, 175, 179, 183, 187, \\
		& 195, 199, 203, 207, 211, 215, 220, 224, 228, 232, 236, 239, 244, 252, 256, 260, 264, \\
		& 267, 272, 275, 280, 284, 292, 296, 300, 304, 308, 312, 316, 320, 328, 340, 344, 348, \\
		& 353, 360, 364, 368, 372, 381, 385, 388, 393, 397, 404, 408, 413, 417, 425, 428, 433, \\
		& 441, 445, 449, 453, 457, 461, 465, 469, 473, 485, 489, 493, 497, 502, 505, 509, 513, \\
		& 517, 521, 525, 529, 533, 537, 541, 546, 549, 553, 558, 562, 566, 569, 574, 578, 586, \\
		& 590, 593, 598, 602, 606, 610, 614, 618, 622, 626, 630, 634, 638, 642, 646 \\
		\hline
		2 & 3, 4, 5, 15, 16, 17, 27, 28, 29, 39, 40, 41, 47, 48, 49, 112, 113, 114, 120, 121, \\
		& 122, 132, 133, 134, 156, 157, 158, 176, 177, 178, 200, 201, 202, 221, 222, 258, 259, \\
		& 281, 282, 283, 301, 302, 303, 345, 346, 347, 365, 366, 367, 389, 426, 427, 446, 447, \\
		& 448, 470, 471, 472, 490, 491, 492, 514, 515, 516, 526, 527, 528, 534, 535, 536, 599, \\
		& 600, 601, 607, 608, 609, 619, 620, 621, 631, 632, 633, 643, 644, 645 \\
		\hline
		3 & 7, 8, 9, 19, 20, 21, 22, 23, 24, 25, 35, 36, 37, 38, 87, 88, 89, 136, 137, 138, 150, 152, 153, 154,\\
		& 180, 181, 182, 196, 197, 198, 208, 209, 210, 212, 213, 214, 261, 262, 263, 265, 266, 276, 277,\\
		& 278, 279, 309, 321, 322, 323, 324, 325, 326, 327, 338, 339, 369, 370, 371, 382, 384, 386, 387,\\
		& 434, 435, 436, 437, 438, 439, 440, 450, 451, 452, 466, 467, 468, 482, 494, 495, 496, 499, 500, \\
		& 510, 511, 512, 559, 560, 561, 611, 612, 613, 623, 624, 625, 627, 628, 629, 639, 640, 641\\
		\hline
		4 & 11, 12, 13, 31, 32, 33, 51, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 124, \\
		& 125, 126, 127, 128, 129, 130, 144, 145, 146, 147, 148, 149, 164, 165, 166, 167, 168, 169, \\
		& 170, 172, 173, 174, 188, 189, 190, 191, 192, 193, 194, 454, 455, 456, 458, 459, 460, 474, \\
		& 475, 476, 477, 478, 479, 480, 481, 483, 484, 498, 501, 503, 504, 518, 519, 520, 522, 523, \\
		& 524, 538, 539, 540, 542, 543, 544, 545, 547, 548, 597, 615, 616, 617, 635, 636, 637 \\
		\hline
		5 & 43, 44, 45, 52, 53, 55, 56, 57, 58, 59, 60, 61, 63, 64, 65, 66, 67, 68, 69, 71, 72, 73, \\
		& 74, 75, 76, 77, 78, 80, 81, 83, 84, 85, 86, 91, 92, 93, 94, 216, 217, 218, 219, 223, 225, \\
		& 226, 227, 231, 233, 234, 235, 237, 238, 240, 241, 242, 243, 245, 246, 247, 251, 253, 254, \\
		& 255, 257, 383, 390, 391, 392, 394, 395, 396, 400, 401, 402, 403, 405, 406, 407, 409, 410, \\
		& 411, 412, 414, 415, 416, 421, 422, 423, 424, 429, 430, 431, 432, 554, 555, 556, 557, 563, \\ 
		& 564, 565, 567, 568, 570, 571, 572, 573, 575, 576, 577, 579, 580, 581, 582, 583, 584, 585, \\
		& 587, 588, 589, 591, 592, 594, 595, 596, 603, 604, 605 \\
		\hline
		6 & 96, 97, 98, 116, 117, 118, 140, 141, 142, 160, 161, 162, 184, 185, 186, 204, 205, 206, \\
		& 229, 230, 248, 249, 250, 268, 269, 270, 271, 273, 274, 285, 286, 287, 288, 289, 290, 291, \\
		& 293, 294, 295, 297, 298, 299, 305, 306, 307, 310, 311, 313, 314, 315, 317, 318, 319, 329, \\
		& 330, 331, 332, 333, 334, 335, 336, 337, 341, 342, 343, 349, 350, 351, 352, 354, 355, 356, \\
		& 357, 358, 359, 361, 362, 363, 373, 374, 375, 376, 377, 378, 379, 380, 398, 399, 418, 419, \\
		& 420, 442, 443, 444, 462, 463, 464, 486, 487, 488, 506, 507, 508, 530, 531, 532, 550, 551, 552 \\
		\hline
	\end{array}
	\]
\end{small}
\end{center}
\end{table}


\end{document}
